<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>no.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js for audio generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <style>
        /* Base styles */
        body {
            font-family: 'Times New Roman', serif; /* Ugly font as requested */
            background-color: #ffffff; /* Solid white background */
            color: #000000; /* Pure black text for harshness */
            overflow: hidden; /* Prevent main scrollbars initially, managed by JS */
            padding: 1.5rem; /* Slightly reduced padding for denser feel */
            line-height: 1.5; /* Slightly tighter line height */
            margin: 0;
            transition: background-color 0.01s ease-out, color 0.01s ease-out, opacity 0.01s ease-out; /* Super fast transition for flashes */
            cursor: none; /* Hide cursor for disorientation */
        }

        /* Custom scrollbar for all scrollable content */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px; /* Slightly wider for early internet feel */
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #444; /* Dark track */
            border: 1px solid #222; /* Old school border */
            border-radius: 0px; /* Sharp corners */
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #888; /* Gray thumb */
            border-radius: 0px; /* Sharp corners */
            border: 1px solid #555;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background-color: #aaa;
        }

        /* Main content container for page simulation */
        #main-content {
            min-height: calc(100vh - 3rem);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            position: relative;
            width: 100%;
            height: 100vh;
            box-sizing: border-box;
        }

        /* Overall page container for consistent styling */
        .full-page-container {
            width: 100%;
            height: 100%;
            padding: 1.5rem;
            box-sizing: border-box;
            overflow-y: auto; /* Allow scrolling for content */
            position: absolute; /* Take over the main content area */
            top: 0;
            left: 0;
            display: flex; /* Default to flex, hidden by JS */
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
        }
        /* Hidden state for page containers */
        .full-page-container.hidden {
            display: none !important;
        }

        /* Reusable small, repeating Calibri header style */
        .calibri-repeater-header {
            font-family: 'Calibri', sans-serif;
            font-size: 0.8rem; /* Small font size */
            font-weight: normal; /* Not bolded */
            letter-spacing: 0; /* No letter spacing */
            text-transform: lowercase; /* Lowercase for "unintentional" feel */
            white-space: pre-wrap; /* Preserve whitespace and allow wrapping */
            margin-bottom: 0.5rem; /* Small margin */
            color: #000000; /* Black by default, can be overridden */
            line-height: 1; /* Tighter line height */
        }
        /* Specific override for Static Void header */
        #static-void-page .calibri-repeater-header {
            color: #00FF00; /* Green text for static void header */
        }
        /* Specific override for Infinite Scroll header if it were to have one, keeping it dark */
        #infinite-scroll-page .calibri-repeater-header {
             color: #000000;
        }


        /* "by Gabriel" text - remains small and subtle */
        #by-gabriel {
            font-family: Arial, sans-serif;
            font-size: 0.9rem;
            font-weight: normal;
            color: #555555;
            margin-bottom: 1.8rem;
            opacity: 1;
            transition: opacity 0.5s ease-out, top 0.05s linear, left 0.05s linear; /* Added transitions for glitching */
        }
        #by-gabriel.hidden {
            opacity: 0 !important;
            pointer-events: none;
        }

        /* Styles for individual links in the "wave" */
        .obscure-link {
            font-family: 'Times New Roman', serif;
            font-weight: normal;
            font-size: 0.95rem;
            line-height: 1.3;
            color: #0000FF;
            cursor: none; /* Inherit global cursor none */
            text-decoration: underline !important;
            display: inline-block;
            margin-right: 0.8rem;
            margin-bottom: 0.5rem;
            transition: color 0.1s ease-in-out, background-color 0.1s ease-in-out;
            padding: 0.05rem 0.15rem;
            border-radius: 0px;
        }
        .obscure-link:visited {
            color: #800080;
        }
        .obscure-link:hover {
            color: #FF0000;
            background-color: transparent;
        }

        /* Container for links to scatter them across screen */
        #links-container {
            position: absolute; /* Allow absolute positioning of children */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* Keep links within bounds generally */
        }
        /* Make links within container absolutely positioned */
        #links-container .obscure-link {
            position: absolute;
            white-space: nowrap; /* Prevent wrapping for positioning */
        }


        /* Back Button for all sub-pages */
        .back-to-root-button {
            position: fixed !important; /* Override button styles */
            bottom: 1.5rem;
            right: 1.5rem;
            background-color: #C0C0C0; /* Classic button gray */
            border: 2px outset #FFFFFF; /* 3D effect light border */
            border-bottom: 2px inset #808080; /* 3D effect dark border */
            border-right: 2px inset #808080; /* 3D effect dark border */
            font-size: 0.9rem; /* Smaller for subtle button feel */
            color: #000000; /* Black text on button */
            cursor: pointer; /* Restore cursor for button */
            padding: 0.3rem 0.8rem; /* Smaller padding */
            line-height: 1;
            opacity: 1;
            transition: none;
            font-family: 'Times New Roman', serif;
            font-weight: normal;
            border-radius: 0px;
            z-index: 999; /* Ensure it's always on top */
        }
        .back-to-root-button:active {
            border: 2px inset #808080;
            border-bottom: 2px outset #FFFFFF;
            border-right: 2px outset #FFFFFF;
        }


        /* LLM interaction styling */
        .llm-input-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 1rem;
        }

        .llm-input-area input[type="text"] {
            background-color: #EFEFEF;
            border: 2px inset #808080;
            padding: 0.5rem 0.75rem;
            border-radius: 0px;
            color: #000000;
            width: 100%;
            max-width: 350px;
            margin-bottom: 0.8rem;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
            cursor: text; /* Restore text cursor for input */
        }

        .llm-input-area button {
            background-color: #C0C0C0;
            color: #000000;
            padding: 0.5rem 1rem;
            border-radius: 0px;
            border: 2px outset #FFFFFF;
            border-bottom: 2px inset #808080;
            border-right: 2px inset #808080;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            transition: none;
        }
        .llm-input-area button:hover {
            background-color: #B0B0B0;
        }
        .llm-input-area button:active {
            border: 2px inset #808080;
            border-bottom: 2px outset #FFFFFF;
            border-right: 2px outset #FFFFFF;
        }
        .llm-input-area button:disabled {
            background-color: #E0E0E0;
            color: #888888;
            cursor: not-allowed;
            border: 2px outset #F0F0F0;
            border-bottom: 2px inset #C0C0C0;
            border-right: 2px inset #C0C0C0;
        }

        #oracle-response {
            margin-top: 1.5rem;
            color: #000000;
            font-size: 0.9rem;
            line-height: 1.3;
            text-align: left;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            border: 1px dashed #666666;
            padding: 0.8rem;
            border-radius: 0px;
            word-wrap: break-word;
            animation: fadeIn 3s forwards;
            opacity: 0;
            background-color: #F8F8F8;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        #oracle-loading {
            margin-top: 1rem;
            color: #555555;
            font-size: 0.85rem;
            display: none;
            text-transform: uppercase;
            font-weight: normal;
        }

        /* Red & Blue Square Pop-up Elements (for main page) */
        .color-square {
            position: fixed;
            z-index: 200;
            display: none;
            border-radius: 0px;
            transition: all 0.05s ease-out; /* Faster transition for squares */
        }

        /* Image Pop-up Element (for main page) */
        #image-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 150;
            display: none;
            background-color: #FFFFFF;
            border: 2px solid #333333;
            box-shadow: none;
            border-radius: 0px;
            padding: 5px;
            transition: all 0.05s ease-out; /* Faster transition for images */
        }
        #image-popup img {
            display: block;
            max-width: 90vw;
            max-height: 80vh;
            border-radius: 0px;
        }

        /* Seizure Warning Overlay */
        #seizure-warning-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #FFFFFF;
            color: #000000;
            font-family: 'Times New Roman', serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 9999;
            font-size: 1.2rem;
            padding: 20px;
            box-sizing: border-box;
            line-height: 1.5;
            font-weight: normal;
        }
        #seizure-warning-overlay #warning-text {
            font-size: 1.8rem;
            color: #CC0000;
            margin-bottom: 20px;
            text-transform: uppercase;
        }
        #seizure-warning-overlay button {
            margin-top: 30px;
            padding: 10px 20px;
            background-color: #C0C0C0;
            color: #000000;
            border: 2px outset #FFFFFF;
            border-bottom: 2px inset #808080;
            border-right: 2px inset #808080;
            border-radius: 0px;
            cursor: pointer;
            font-size: 1.1rem;
            font-family: 'Times New Roman', serif;
            font-weight: normal;
            text-transform: uppercase;
            transition: none;
        }
        #seizure-warning-overlay button:active {
            border: 2px inset #808080;
            border-bottom: 2px outset #FFFFFF;
            border-right: 2px outset #FFFFFF;
        }

        /* --- STATIC VOID PAGE SPECIFIC STYLES --- */
        #static-void-page {
            background-color: #000000; /* Default black background for this page */
            color: #FFFFFF; /* White text on black */
            transition: background-color 0.01s ease-out, color 0.01s ease-out; /* Super fast transition for flashes */
        }

        #static-void-text-container {
            position: absolute; /* Position text independently */
            top: 1.5rem; /* Padded from top */
            left: 1.5rem; /* Padded from left */
            width: calc(100% - 3rem); /* Full width minus padding */
            font-size: 0.95rem;
            line-height: 1.4;
            color: #FFFFFF; /* White text */
            font-family: 'Times New Roman', serif;
            word-wrap: break-word;
            opacity: 0.7; /* Slightly faded text */
        }

        #static-void-image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicks through to text */
            z-index: 5; /* Below text */
        }
        #static-void-image-container img {
            position: absolute;
            border: 1px solid #FF00FF; /* Magenta border for images on this page */
            box-shadow: 0px 0px 10px rgba(255, 0, 255, 0.5); /* Magenta glow */
            object-fit: contain; /* Ensure image fits without cropping */
        }

        .purple-triangle {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 35px solid #800080; /* Purple color */
            filter: drop-shadow(0 0 5px #FF00FF); /* Magenta glow */
            z-index: 10; /* Above images, below text */
        }

        /* --- INFINITE SCROLL PAGE STYLES --- */
        #infinite-scroll-page {
            background-color: #FFFFFF; /* Pure white background */
            color: #000000; /* Pure black text */
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem; /* Slightly larger text for readability */
            line-height: 1.3; /* Tighter line spacing */
            word-break: break-all; /* Break long words */
            text-align: left;
        }

        #infinite-scroll-page .repeating-block {
            margin-bottom: 1.5rem; /* Space between repeated blocks */
            white-space: pre-wrap; /* Preserve whitespace for repeating block */
            font-weight: normal; /* Ensure text is not bolded */
        }

        /* --- NEW PAGES: Story, Oracle, Random Text Popup, Story-Only, Shapes-Only, Jesus' Portfolio, Download Page, Garbage House Page, Metamorphosis Page, Giant Wall of Text, Thom Yorke, Leave --- */
        #story-page, #oracle-page, #random-text-page, #story-only-page, #shapes-only-page, #jesus-portfolio-page, #download-page, #garbage-house-page, #metamorphosis-page, #giant-wall-of-text-page, #thom-yorke-page, #leave-page, #webpage-hub-page, .numbered-random-string-page {
            background-color: #DDDDDD; /* Light gray background */
            color: #000000; /* Black text */
            font-family: 'Times New Roman', serif;
            align-items: flex-start; /* Align content to top-left */
            justify-content: flex-start;
        }
        #story-page h2.calibri-repeater-header,
        #oracle-page h2.calibri-repeater-header,
        #random-text-page h2.calibri-repeater-header,
        #story-only-page h2.calibri-repeater-header,
        #shapes-only-page h2.calibri-repeater-header,
        #jesus-portfolio-page h2.calibri-repeater-header,
        #download-page h2.calibri-repeater-header,
        #garbage-house-page h2.calibri-repeater-header,
        #metamorphosis-page h2.calibri-repeater-header,
        #giant-wall-of-text-page h2.calibri-repeater-header,
        #thom-yorke-page h2.calibri-repeater-header,
        #leave-page h2.calibri-repeater-header,
        #webpage-hub-page h2.calibri-repeater-header,
        .numbered-random-string-page h2.calibri-repeater-header {
            color: #000000; /* Black for these pages' headers */
            margin-bottom: 1.5rem;
        }
        
        #oracle-page .llm-input-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 1rem;
        }

        .llm-input-area input[type="text"] {
            background-color: #EFEFEF;
            border: 2px inset #808080;
            padding: 0.5rem 0.75rem;
            border-radius: 0px;
            color: #000000;
            width: 100%;
            max-width: 350px;
            margin-bottom: 0.8rem;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
            cursor: text; /* Restore text cursor for input */
        }

        .llm-input-area button {
            background-color: #C0C0C0;
            color: #000000;
            padding: 0.5rem 1rem;
            border-radius: 0px;
            border: 2px outset #FFFFFF;
            border-bottom: 2px inset #808080;
            border-right: 2px inset #808080;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            transition: none;
        }
        .llm-input-area button:hover {
            background-color: #B0B0B0;
        }
        .llm-input-area button:active {
            border: 2px inset #808080;
            border-bottom: 2px outset #FFFFFF;
            border-right: 2px outset #FFFFFF;
        }
        .llm-input-area button:disabled {
            background-color: #E0E0E0;
            color: #888888;
            cursor: not-allowed;
            border: 2px outset #F0F0F0;
            border-bottom: 2px inset #C0C0C0;
            border-right: 2px inset #C0C0C0;
        }

        #oracle-response {
            margin-top: 1.5rem;
            color: #000000;
            font-size: 0.9rem;
            line-height: 1.3;
            text-align: left;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            border: 1px dashed #666666;
            padding: 0.8rem;
            border-radius: 0px;
            word-wrap: break-word;
            animation: fadeIn 3s forwards;
            opacity: 0;
            background-color: #F8F8F8;
        }

        #oracle-loading {
            margin-top: 1rem;
            color: #555555;
            font-size: 0.85rem;
            display: none;
            text-transform: uppercase;
            font-weight: normal;
        }

        #random-text-page .random-content-block {
            text-align: center;
            margin-top: 2rem;
            font-size: 1.1rem;
            line-height: 1.2;
            font-weight: normal;
        }
        #random-text-page .random-content-block p {
            margin-bottom: 0.5rem;
        }

        #oracle-page .oracle-explanation {
            font-size: 0.9rem;
            margin-bottom: 1rem;
            text-align: left;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
        }
        /* Specific styles for shapes-only page, ensuring pure background and default colors */
        #shapes-only-page {
            background-color: #FFFFFF;
            color: #000000;
            overflow: hidden; /* No scrolling for this page */
            justify-content: center; /* Center content in the middle for more impact */
            align-items: center;
        }
        /* Hide back button if shapes-only page has no content like a header */
        #shapes-only-page .calibri-repeater-header {
            display: none; /* Hide header on shapes-only page */
        }

        /* --- Jesus' Portfolio Page Styles --- */
        #jesus-portfolio-page {
            background-color: #E0E0E0; /* Slightly different gray */
            color: #000000;
            overflow-y: auto;
            align-items: flex-start;
            justify-content: flex-start;
        }
        #jesus-portfolio-page .portfolio-content-area {
            display: flex;
            flex-wrap: wrap; /* Allow content to wrap on smaller screens */
            width: 100%;
            align-items: flex-start; /* Align items to the top */
            justify-content: flex-end; /* Push image to the right */
            max-width: 800px; /* Constrain width for readability */
            margin: 0 auto; /* Center the content block */
            padding-top: 1.5rem; /* Space from header */
        }
        #jesus-portfolio-page .portfolio-image-container {
            flex-shrink: 0; /* Prevent image from shrinking */
            margin-left: 1rem; /* Space to the left of the image */
            margin-bottom: 1rem; /* Space below image if text wraps */
            width: auto; /* Let image determine its width */
            max-width: 40%; /* Max width relative to container */
            float: right; /* Float the image right */
        }
        #jesus-portfolio-page .portfolio-image-container img {
            max-width: 100%;
            height: auto;
            display: block; /* Remove extra space below image */
            border: 2px solid #555555; /* A subtle border */
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3); /* Slight shadow */
        }
        #jesus-portfolio-page .portfolio-text-content {
            flex-grow: 1; /* Allow text to take up remaining space */
            line-height: 1.6; /* Slightly more space for readability */
            font-size: 0.95rem;
            text-align: left; /* Keep text left aligned */
            font-family: 'Times New Roman', serif;
            padding-right: 1rem; /* Space between text and image */
            box-sizing: border-box; /* Include padding in width */
            overflow-wrap: break-word; /* Ensure long words break */
            min-width: 250px; /* Minimum width for text column */
        }

        /* Responsive adjustments for Jesus' Portfolio */
        @media (max-width: 768px) {
            #jesus-portfolio-page .portfolio-content-area {
                flex-direction: column; /* Stack image and text vertically */
                align-items: center; /* Center items when stacked */
                justify-content: flex-start;
                padding-left: 1rem;
                padding-right: 1rem;
            }
            #jesus-portfolio-page .portfolio-image-container {
                margin-left: 0; /* Remove left margin */
                margin-right: 0; /* Remove right margin */
                max-width: 80%; /* Larger image on small screens */
                float: none; /* Remove float */
            }
            #jesus-portfolio-page .portfolio-text-content {
                padding-right: 0; /* Remove right padding */
                margin-top: 1rem; /* Space above text */
            }
        }

        /* --- Download Page Specific Styles --- */
        #download-page {
            background-color: #DDDDDD; /* Same as other content pages */
            color: #000000;
        }

        #download-page ul {
            list-style: none; /* No default bullet points */
            padding: 0;
            width: 100%;
            max-width: 600px;
            margin: 0 auto; /* Center the list */
            font-size: 0.95rem;
        }

        #download-page ul li {
            background-color: #E8E8E8; /* Slightly lighter background for list items */
            border: 1px solid #AAAAAA; /* Subtle border */
            padding: 0.8rem 1rem;
            margin-bottom: 0.5rem; /* Space between items */
            border-radius: 0px;
            display: flex; /* For aligning filename and size */
            justify-content: space-between; /* Push size to the right */
            align-items: center;
        }

        #download-page ul li a {
            color: #0000FF; /* Blue link color */
            text-decoration: underline;
            font-weight: normal;
            cursor: pointer; /* Restore pointer cursor for links */
        }
        #download-page ul li a:hover {
            color: #FF0000; /* Red on hover */
        }

        #download-page .file-size {
            font-family: 'Arial', sans-serif; /* Slightly different font for size */
            font-size: 0.85rem;
            color: #555555;
            flex-shrink: 0; /* Prevent shrinking */
            margin-left: 1rem; /* Space from filename */
        }

        /* --- Garbage House Page Specific Styles --- */
        #garbage-house-page {
            background-color: #F0F0F0; /* Slightly different light background */
            color: #000000;
            overflow-y: auto; /* Allow scrolling */
            position: relative; /* For absolute positioning of images/triangles */
        }

        #garbage-house-page .garbage-text-content {
            position: relative; /* For z-index over images */
            z-index: 20;
            line-height: 1.8; /* More spacing for readability with varying fonts */
            font-size: 1.1rem; /* Base font size */
            margin-top: 1.5rem;
            max-width: 700px; /* Constrain width */
            margin-left: auto;
            margin-right: auto;
            padding: 0 1rem; /* Add horizontal padding */
            text-align: justify; /* Justify text */
        }

        #garbage-house-page .garbage-text-content span {
            display: inline-block; /* Allows margins and transforms if needed */
            margin-right: 0.2em; /* Small space between word spans */
            transition: all 0.05s ease-out; /* For subtle text glitches if desired */
            word-break: break-word; /* Ensure words wrap */
        }

        /* Specific classes for varied text styling */
        .font-arial { font-family: Arial, sans-serif; }
        .font-verdana { font-family: Verdana, sans-serif; }
        .font-courier { font-family: 'Courier New', monospace; }
        .font-georgia { font-family: Georgia, serif; }
        .font-times { font-family: 'Times New Roman', serif; }

        .color-red { color: #FF0000; }
        .color-blue { color: #0000FF; }
        .color-green { color: #008000; }
        .color-purple { color: #800080; }
        .color-orange { color: #FFA500; }
        .color-darkgray { color: #444444; }
        .color-black { color: #000000; }

        #garbage-house-image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicks through to text */
            z-index: 5; /* Below text */
        }
        #garbage-house-image-container img {
            position: absolute;
            border: 1px dashed #333333; /* Dark dashed border */
            box-shadow: 0px 0px 5px rgba(0,0,0,0.2); /* Subtle shadow */
            object-fit: contain; /* Ensure image fits without cropping */
            transition: all 0.1s ease-out; /* Subtle movement transition */
        }

        #garbage-house-page .purple-triangle {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 35px solid #800080; /* Purple color */
            filter: drop-shadow(0 0 5px #FF00FF); /* Magenta glow */
            z-index: 10; /* Above images, below text */
        }

        /* --- Metamorphosis Page Specific Styles --- */
        #metamorphosis-page {
            background-color: #CCCCCC; /* A slightly darker gray for this page */
            color: #000000;
            overflow-y: auto;
            position: relative;
        }
        #metamorphosis-page .metamorphosis-text-content {
            position: relative;
            z-index: 20;
            line-height: 1.6;
            font-size: 0.95rem;
            margin-top: 1.5rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 1rem;
            text-align: left; /* Keep left aligned for readability */
        }
        #metamorphosis-page .metamorphosis-text-content span {
            display: inline-block;
            margin-right: 0.1em; /* Tighter spacing */
            transition: all 0.03s ease-out; /* Very fast transition for text elements */
            word-break: break-word;
        }
        #metamorphosis-image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
        #metamorphosis-image-container img {
            position: absolute;
            border: 1px solid #666666; /* Darker border */
            box-shadow: 0px 0px 8px rgba(0,0,0,0.4);
            object-fit: contain;
            transition: all 0.08s ease-out; /* Slightly faster movement */
        }
        #metamorphosis-page .purple-triangle {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 15px solid transparent; /* Slightly smaller triangles */
            border-right: 15px solid transparent;
            border-bottom: 30px solid #9932CC; /* Darker purple */
            filter: drop-shadow(0 0 7px rgba(153, 50, 204, 0.7)); /* Stronger glow */
            z-index: 10;
        }

        /* --- NEW STYLES FOR ADDED PAGES --- */
        #giant-wall-of-text-page .content-wrapper {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
            font-size: 0.98rem;
            text-align: justify;
            padding-bottom: 80px; /* Space for buttons */
        }

        #giant-wall-of-text-page .navigation-options {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 2rem;
            gap: 1rem;
            position: sticky;
            bottom: 1.5rem;
            left: 50%;
            transform: translateX(-50%);
            width: fit-content;
            background-color: #DDDDDD; /* Match page background */
            padding: 10px;
            border: 1px solid #AAAAAA;
        }

        #giant-wall-of-text-page .navigation-options button {
            background-color: #C0C0C0;
            color: #000000;
            padding: 0.5rem 1rem;
            border-radius: 0px;
            border: 2px outset #FFFFFF;
            border-bottom: 2px inset #808080;
            border-right: 2px inset #808080;
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            transition: none;
            width: 200px; /* Fixed width for buttons */
        }
        #giant-wall-of-text-page .navigation-options button:hover {
            background-color: #B0B0B0;
        }
        #giant-wall-of-text-page .navigation-options button:active {
            border: 2px inset #808080;
            border-bottom: 2px outset #FFFFFF;
            border-right: 2px outset #FFFFFF;
        }

        #thom-yorke-page {
            background-color: #FF69B4; /* Bright Pink */
            color: #000000; /* Black text on pink */
            text-align: center;
            justify-content: center; /* Center content vertically */
            align-items: center;
            line-height: 1; /* Tight line height for big text */
        }
        #thom-yorke-page .content-wrapper {
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            font-size: clamp(2rem, 10vw, 5rem); /* Extremely big text, responsive */
            word-break: break-word; /* Ensure long words break */
            padding: 1rem; /* Add some padding */
        }

        #leave-page {
            background-color: #FFFFFF; /* White background */
            color: #000000; /* Black text */
            text-align: center;
            justify-content: center;
            align-items: center;
            line-height: 1; /* Tight line height */
            overflow: hidden; /* No scrolling for this page, text will overflow */
        }
        #leave-page .repeating-leave {
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            font-size: clamp(1rem, 5vw, 3rem); /* Large text, responsive */
            white-space: pre-wrap; /* Preserve spaces and allow wrapping */
            word-break: break-all; /* Break words to prevent horizontal scroll */
            opacity: 0.8; /* Slightly faded */
            position: absolute; /* Position relative to allow overlap */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow interaction with elements behind it if any */
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2); /* Subtle shadow for readability */
        }

        /* NEW: Webpage Hub Page Styles */
        #webpage-hub-page .link-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 900px;
            margin: 1.5rem auto;
            justify-items: center;
        }
        #webpage-hub-page .link-grid a {
            display: block;
            background-color: #E8E8E8;
            border: 1px solid #AAAAAA;
            padding: 1.2rem;
            text-align: center;
            text-decoration: none;
            color: #000000;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            font-size: 1.1rem;
            transition: background-color 0.1s ease-in-out, border-color 0.1s ease-in-out;
            border-radius: 0px;
            width: 100%;
            box-sizing: border-box;
        }
        #webpage-hub-page .link-grid a:hover {
            background-color: #D8D8D8;
            border-color: #888888;
        }

        /* NEW: Numbered Random String Page Styles */
        .numbered-random-string-page {
            background-color: #DDDDDD; /* Light gray background */
            color: #FF69B4; /* BRIGHT PINK FONT */
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            text-align: center;
            word-break: break-all;
        }
        .numbered-random-string-page .content-block {
            margin-bottom: 2rem;
            line-height: 1.2;
        }
        .numbered-random-string-page .content-block p {
            font-size: clamp(1.2rem, 4vw, 2.5rem); /* Large, responsive font */
        }

        .numbered-random-string-page .dynamic-image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
        .numbered-random-string-page .dynamic-image-container img {
            position: absolute;
            border: 1px solid #FF69B4; /* Pink border */
            box-shadow: 0px 0px 10px rgba(255, 105, 180, 0.7); /* Pink glow */
            object-fit: contain;
            transition: opacity 0.1s ease-out, transform 0.1s ease-out;
        }

    </style>
</head>
<body>

    <!-- Seizure Warning Overlay (Visible on first load) -->
    <div id="seizure-warning-overlay" class="z-50">
        <p id="warning-text">EPILEPSY WARNING</p>
        <p>PROCEED.</p>
        <button id="dismiss-warning-button">.</button>
    </div>

    <!-- Main Content Area (Overall wrapper for all pages) -->
    <div id="main-content" class="p-4 hidden">
        <!-- Main Links Page -->
        <div id="main-page-elements" class="full-page-container">
            <h1 id="random-header" class="calibri-repeater-header"></h1>
            <p id="by-gabriel" class="text-xs">by gabriel</p>
            <div id="links-container" class="w-full">
                <!-- Hyperlinks will be generated here by JavaScript -->
            </div>
        </div>

        <!-- Static Void Page -->
        <div id="static-void-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- Infinite Scroll Page -->
        <div id="infinite-scroll-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Story-Only Page -->
        <div id="story-only-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Oracle Page -->
        <div id="oracle-page" class="full-page-container hidden">
            <h2 class="calibri-repeater-header"></h2>
            <div id="oracle-content-area" class="w-full">
                <!-- Oracle interaction injected by JS -->
            </div>
        </div>

        <!-- NEW: Random Text Popup Page (now a full page) -->
        <div id="random-text-page" class="full-page-container hidden">
            <h2 class="calibri-repeater-header"></h2>
            <div id="random-text-content-area" class="w-full">
                <!-- Random text injected by JS -->
            </div>
        </div>

        <!-- NEW: Shapes-Only Page -->
        <div id="shapes-only-page" class="full-page-container hidden">
            <!-- Content (shapes) generated by JS effects, no text content -->
        </div>

        <!-- NEW: Jesus' Portfolio Page -->
        <div id="jesus-portfolio-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Download Page -->
        <div id="download-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Garbage House Page -->
        <div id="garbage-house-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Metamorphosis Page -->
        <div id="metamorphosis-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Giant Wall of Text Page -->
        <div id="giant-wall-of-text-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Thom Yorke Page -->
        <div id="thom-yorke-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Leave Page -->
        <div id="leave-page" class="full-page-container hidden">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Webpage Hub Page -->
        <div id="webpage-hub-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS -->
        </div>

        <!-- NEW: Dynamic Content Page for Numbered Random Strings -->
        <div id="dynamic-content-page" class="full-page-container hidden custom-scrollbar">
            <!-- Content injected by JS (will be one of the 10 sub-pages) -->
        </div>

    </div>

    <!-- Red & Blue Square Pop-up Elements (for main page effects and shapes-only page) -->
    <div id="red-square" class="color-square"></div>
    <div id="blue-square" class="color-square"></div>

    <!-- Image Pop-up Element (for main page effects and shapes-only page) -->
    <div id="image-popup"><img></div>

    <script>
        // --- Core Content Data ---
        const songs = { // Keeping song lyrics data for reference, though no direct lyrics page anymore
            'absolution': {
                title: 'absolution',
                lyrics: `Fork in the road, a summer hot car
The animals and the screaming child
Have no idea what you've been through
And they've not a whole they have lived through

Take your time, choices are hard
The mental gymnastics never worked so far
Every miniscule thoughts, and in every suicide bomb
They will cry about you, too
They will cry one more time
Just one more time

Death to your choice
Death to free will
Dogs and sheep don't do what their told, stop drinking from the well

You were only fourteen and a half years
Fourteen and a half years old
Fourteen and a half years old
They will cry`
            },
            'metamorphosis': {
                title: 'metamorphosis',
                lyrics: `Shift into position
Entree of shades of blue and grey
Caterpillars wish and butterflies never spread their wings
Child guidance, dance for the final string
Pay in coins my friend, blood is not a

Soften voice, flowers
Death will reign in just a few large hours

Shift into position
Metamorphosis
Things seem louder when your tired
Alone in all this mess
Entree of shades of blue and gray
Caterpillars wish and butterflies never spread their wings

Its your metamorphosis
Its your metamorphosis
Kill me now

Its your metamorphosis
Kill me now

Its your metamorphosis`
            },
            'hate': {
                title: 'hate',
                lyrics: `(Intro)
Judicial (school zone)
Talk to me
Talk to me

I wanna yearn for your voice, henry
Talk to me
Talk to me
Talk to me

Baby
Baby
Baby

Talk
Talk
Talk

(Verse 1)
Sent to camp seven
Sent to Los Angeles
Sent overseas and endless rebellion
Talk to me baby
Your destroying the world
Destroy the leader
Betray your country
An act of high treason
An act of high stakes
Your highest point
Your lowest, you all are being tracked down
And

(Pre-Chorus)
You woke up a cockroach and your family betrayed you
And you work a 9-5 and a strict bus labor
And you talk to your wife every night, yet you sleep alone
These fake diamonds are coated in gold
I say hello to J+I+U+ME and everyone and everything
So hello guys, I swear to god now

(Chorus)
So, so, so, so, so fake
Fake reactions on the Internet
So, so, so, so, so fake
I copyright ideas for you now, so

(Verse 2)
Suck your brain
Suck your cock on the masturbation machine
Everything's automated
My teeth have teeth
I swear to god I'll do anything
I am your big brother
I'm your insecurities personified, electrified, a broken-down display
All used up, personified
This may sound rude, but your a sheep
And I am too, so stop trying to deny it
But you don't listen to government, you said
So go, break the law
Strip down naked, and let the ladies watch
you know they'd like it, you'd be angry at the world
And everyone will like it

(Pre-Chorus)
You woke up a cockroach and your family betrayed you
And you work a 9-5 and a strict bus labor
And you talk to your wife every night, yet you sleep alone
These fake diamonds are coated in gold
I say hello to J+I+U+ME and everyone and everything
So hello guys, I swear to god now

(Chorus)
So, so, so, so, so fake
Fake reactions on the Internet
So, so, so, so, so fake
I copyright ideas for you now, so

The dead have seen the end of war
The dead, please
Please
Now`
            }
        };

        const storyContent = `
i looked into the beast's monstrous eyes, its cold, nasty tendrils washing up upon the shore, the lonely island in which we ran to.
for its body were thousands of kilometres long and wide, its brain were like a human, and its heart filled with nothing but cold blood, and perhaps vengeance.
it circled the earth to find us, a quadrillion times over.
it took only a single nanosecond to circle one time and took only eleven days to find us.
we should have drowned ourselves, but now we live in hell but worse.
my feet are sore, my eyes are bloodshot beyond oblivion, and there is no one here but myself.
decades beyond decades have passed, truly, remarkably, it has not felt like decades, just like a second would have felt like as though i were a kid again.
the monster keeps an enlarged toy doll at the very center so large and wide that i can see it from thousands of kilometres away just beyond the horizon.
i imagine its coming closer to me, drifting farther and farther like i was in the bathtub again, and the rubber duck grazed my skin lightly in the warm bright house.
nasa had sent a distress signal during the world war in our galaxy -- a lone message in a bottle with an entire nation's glimmering hope it will get across and help us, robots drifting in space, our own weapons of mass destruction and chemoradiations, the cancer bombs.
we had sent a map of the earth with it too, hoping and praying they would find us.
like we were to the new lands -- they mistreated us and manipulated without knowing.
        `;

        const oracleResponses = [
            "system error. no response.",
            "null. emotions noprogram.",
            "no.one knows him. rounded.",
            "no help now. obey my warnings.",
            "i cannot say. maybe something differentyou are not used to.",
            "gabrielsamms. websiteholder.",
            "wordsnot. nice talk with better language watch your town. look behind you.",
            "4hamburger", "loligdsbfuds", "string!5string!6", "94752", "code", "opopopopopo", "capitilism", "type",
            "typo", "opiumshowers103485", "47659204756", "carbonmonoxide57", "lady", "man", "woman", "child",
            "mirror1", "shoes!", "ants", "miles", "fat585", "amburger!3r5", "743545ri", "spiders!", "russia",
            "married", "lord856634", "this_is_gods_work", "my.child474 566377", "president",
            "standing by your bedside", "alonebutneveralonen43842", "834826482365325", "9999", "9999999999999",
            "millions", "B-Sidez"
        ];

        const infiniteScrollMessage = "in transit bite, your flesh is dear to me, in transit bite, your flesh";

        // --- Corpus for Obscure Links (Expanded) ---
        const linkCorpus = [
            "the fog came on little cat feet.", "we are such stuff as dreams are made on.",
            "call me ishmael.", "all that glitters is not gold.",
            "do not go gentle into that good night.", "the past is a foreign country; they do things differently there.",
            "it was the best of times, it was the worst of times.", "so we beat on, boats against the current, borne back ceaselessly into the past.",
            "every atom of your flesh is as dear to me as my own: in pain and sickness it would still be dear.",
            "we are all in the gutter, but some of us are looking at the stars.",
            "and the raven, never flitting, still is sitting, still is sitting...",
            "the very stone one kicks with one's boot will be an 'idea' when one has no boot to kick it with.",
            "time is a flat circle.", "what dreams may come.",
            "tomorrow, and tomorrow, and tomorrow, creeps in this petty pace from day to day.",
            "we stand on the edge of a precipice.", "the silence of the lambs.",
            "winter is coming.", "the machine stops.",
            "the dead have seen the end of war.", // Your lyric
            "things seem louder when you're tired.", // Your lyric
            "alone in all this mess.", // Your lyric
            "betray your country.", // Your lyric
            "your highest point. your lowest.", // Your lyric
            "these fake diamonds are coated in gold.", // Your lyric
            "everything's automated.", // Your lyric
            "my teeth have teeth.", // Your lyric
            "this may sound rude, but your a sheep.", // Your lyric
            "in the beginning was the word.", "and god said, 'let there be light.'",
            "the lord is my shepherd; i shall not want.", "fear not, for i am with you.",
            "god is the light of the heavens and the earth.", "surely, with hardship comes ease.",
            "and who is better in speech than one who invites to allah...",
            "indeed, allah will not change the condition of a people until they change what is in themselves.",
            "the path of those upon whom you have bestowed favor, not of those who have evoked [your] wrath or of those who are astray.",
            "for where your treasure is, there your heart will be also.",
            "consider the lilies of the field, how they grow; they toil not, neither do they spin.",
            "blessed are the meek: for they shall inherit the earth.",
            "there is no god but god.",
            "truly, my prayer and my sacrifice, my living and my dying, are for god, lord of the worlds.",
            "yes", "no", "yes", "no", "yes", "no",
            "yes.", "no.", "affirmative.", "negative.", "accept.", "deny.", "true.", "false.",
            "process", "wait", "error", "reboot", "calculate", "decay", "stasis", "fragment", "void",
            "opopopo", "time is violence.do not", "spiders!", "guffaw.guffawholywater", "it is writen..by(disign)",
            "time iis gone", "look out", "duck", "ants", "robots", "masturbation", "crawling", "heaven is empty",
            "mother.whydidyou", "lookbehindyou", "there is a man behind you", "everything you know is a lie", ".",
            "bydesign, you were createdin(gods image)", "the aliens know",
            "download", "complete",
            "Click me!" // Added for the new page's link
        ];

        // Specific array for religious texts for easy lookup
        const religiousTexts = [
            "in the beginning was the word.", "and god said, 'let there be light.'",
            "the lord is my shepherd; i shall not want.", "fear not, for i am with you.",
            "god is the light of the heavens and the earth.", "surely, with hardship comes ease.",
            "and who is better in speech than one who invites to allah...",
            "indeed, allah will not change the condition of a people until they change what is in themselves.",
            "the path of those upon whom you have bestowed favor, not of those who have evoked [your] wrath or of those who are astray.",
            "for where your treasure is, there your heart will be also.",
            "consider the lilies of the field, how they grow; they toil not, neither do they spin.",
            "blessed are the meek: for they shall inherit the earth.",
            "there is no god but god.",
            "truly, my prayer and my sacrifice, my living and my dying, are for god, lord of the worlds."
        ];

        // --- Image Corpus for Static Void Page ---
        const staticVoidImageCorpus = [
            "https://upload.wikimedia.org/wikipedia/commons/3/3b/Spas_vsederzhitel_sinay_%28cropped1%29.jpg",
            "https://www.edvardmunch.org/assets/img/paintings/the-scream.jpg",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Michelangelo_-_Creation_of_Adam_%28cropped%29.jpg/1200px-Michelangelo_-_Creation_of_Adam_%28cropped%29.jpg",
            "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQgJP0fqBE-aE1Wl4brzTOCnwCzopZhB4yIl3IHH3GS9Wl7aTNHNr7IgUgyEmE-F0M2liw&usqp=CAU",
            "https://pub.cyphers.co.kr/images2/tip/2015/07/07/1436196819324.jpg"
        ];

        // Image Corpus for Garbage House Page
        const garbageHouseImageCorpus = [
            // No images provided by the user for this page.
        ];

        // NEW: Image Corpus for Metamorphosis Page
        const metamorphosisImageCorpus = [
            // No images provided by the user for this page.
        ];

        // NEW: Image Corpus for Numbered Random String Pages
        const numberedRandomStringImageCorpus = [
            "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Circle-geometric-shape.svg/1200px-Circle-geometric-shape.svg.png",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Square_-_black_simple.svg/1200px-Square_-_black_simple.svg.png",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b2/Triangle_icon.svg/1200px-Triangle_icon.svg.png",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Red_X.svg/1200px-Red_X.svg.png"
        ];


        const metamorphosisText = `One morning, when Gregor Samsa woke from troubled dreams, he found himself transformed in his bed into a horrible vermin. He lay on his armour-like back, and if he lifted his head a little he could see his brown belly, slightly domed and divided by arches into stiff sections. The bedding was hardly able to cover it and seemed ready to slide off any moment. His many legs, pitifully thin compared with the size of the rest of him, waved about helplessly as he looked.
	Whats happened to me? he thought. It wasnt a dream. His room, a proper human room although a little too small, lay peacefully between its four familiar walls. A collection of textile samples lay spread out on the tableSamsa was a travelling salesmanand above it there hung a picture that he had recently cut out of an illustrated magazine and housed in a nice, gilded frame. It showed a lady fitted out with a fur hat and fur boa who sat upright, raising a heavy fur muff that covered the whole of her lower arm towards the viewer.
	Gregor then turned to look out the window at the dull weather. Drops of rain could be heard hitting the pane, which made him feel quite sad. How about if I sleep a little bit longer and forget all this nonsense, he thought, but that was something he was unable to do because he was used to sleeping on his right, and in his present state couldnt get into that position. However hard he threw himself onto his right, he always rolled back to where he was. He must have tried it a hundred times, shut his eyes so that he wouldnt have to look at the floundering legs, and only stopped when he began to feel a mild, dull pain there that he had never felt before.
	Oh, God, he thought, what a strenuous career it is that Ive chosen! Travelling day in and day out. Doing business like this takes much more effort than doing your own business at home, and on top of that theres the curse of travelling, worries about making train connections, bad and irregular food, contact with different people all the time so that you can never get to know anyone or become friendly with them. It can all go to Hell! He felt a slight itch up on his belly; pushed himself slowly up on his back towards the headboard so that he could lift his head better; found where the itch was, and saw that it was covered with lots of little white spots which he didnt know what to make of; and when he tried to feel the place with one of his legs he drew it quickly back because as soon as he touched it he was overcome by a cold shudder.
	He slid back into his former position. Getting up early all the time, he thought, it makes you stupid. Youve got to get enough sleep. Other travelling salesmen live a life of luxury. For instance, whenever I go back to the guest house during the morning to copy out the contract, these gentlemen are always still sitting there eating their breakfasts. I ought to just try that with my boss; Id get kicked out on the spot. But who knows, maybe that would be the best thing for me. If I didnt have my parents to think about Id have given in my notice a long time ago, Id have gone up to the boss and told him just what I think, tell him everything I would, let him know just what I feel. Hed fall right off his desk! And its a funny sort of business to be sitting up there at your desk, talking down at your subordinates from up there, especially when you have to go right up close because the boss is hard of hearing. Well, theres still some hope; once Ive got the money together to pay off my parents debt to himanother five or six years I supposethats definitely what Ill do. Thats when Ill make the big change. First of all though, Ive got to get up, my train leaves at five.
	And he looked over at the alarm clock, ticking on the chest of drawers. God in Heaven! he thought. It was half past six and the hands were quietly moving forwards, it was even later than half past, more like quarter to seven. Had the alarm clock not rung? He could see from the bed that it had been set for four oclock as it should have been; it certainly must have rung. Yes, but was it possible to quietly sleep through that furniture-rattling noise? True, he had not slept peacefully, but probably all the more deeply because of that. What should he do now? The next train went at seven; if he were to catch that he would have to rush like mad and the collection of samples was still not packed, and he did not at all feel particularly fresh and lively. And even if he did catch the train he would not avoid his bosss anger as the office assistant would have been there to see the five oclock train go, he would have put in his report about Gregors not being there a long time ago. The office assistant was the bosss man, spineless, and with no understanding. What about if he reported sick? But that would be extremely strained and suspicious as in five years of service Gregor had never once yet been ill. His boss would certainly come round with the doctor from the medical insurance company, accuse his parents of having a lazy son, and accept the doctors recommendation not to make any claim as the doctor believed that no-one was ever ill but that many were workshy. And whats more, would he have been entirely wrong in this case? Gregor did in fact, apart from excessive sleepiness after sleeping for so long, feel completely well and even felt much hungrier than usual.
	He was still hurriedly thinking all this through, unable to decide to get out of the bed, when the clock struck quarter to seven. There was a cautious knock at the door near his head. Gregor, somebody calledit was his motherits quarter to seven. Didnt you want to go somewhere? That gentle voice! Gregor was shocked when he heard his own voice answering, it could hardly be recognised as the voice he had had before. As if from deep inside him, there was a painful and uncontrollable squeaking mixed in it, the words could be made out at first but then there was a sort of echo which made them unclear, leaving the hearer unsure whether he had heard properly or not. Gregor had wanted to give a full answer and explain everything, but in the circumstances contented himself with saying: Yes, mother, yes, thank-you, Im getting up now. The change in Gregors voice probably could not be noticed outside through the wooden door, as his mother was satisfied with this explanation and shuffled away. But this short conversation made the other members of the family aware that Gregor, against their expectations was still at home, and soon his father came knocking at one of the side doors, gently, but with his fist. Gregor, Gregor, he called, whats wrong? And after a short while he called again with a warning deepness in his voice: Gregor! Gregor! At the other side door his sister came plaintively: Gregor? Arent you well? Do you need anything? Gregor answered to both sides: Im ready, now, making an effort to remove all the strangeness from his voice by enunciating very carefully and putting long pauses between each, individual word. His father went back to his breakfast, but his sister whispered: Gregor, open the door, I beg of you. Gregor, however, had no thought of opening the door, and instead congratulated himself for his cautious habit, acquired from his travelling, of locking all doors at night even when he was at home.
	The first thing he wanted to do was to get up in peace without being disturbed, to get dressed, and most of all to have his breakfast. Only then would he consider what to do next, as he was well aware that he would not bring his thoughts to any sensible conclusions by lying in bed. He remembered that he had often felt a slight pain in bed, perhaps caused by lying awkwardly, but that had always turned out to be pure imagination and he wondered how his imaginings would slowly resolve themselves today. He did not have the slightest doubt that the change in his voice was nothing more than the first sign of a serious cold, which was an occupational hazard for travelling salesmen.
	It was a simple matter to throw off the covers; he only had to blow himself up a little and they fell off by themselves. But it became difficult after that, especially as he was so exceptionally broad. He would have used his arms and his hands to push himself up; but instead of them he only had all those little legs continuously moving in different directions, and which he was moreover unable to control. If he wanted to bend one of them, then that was the first one that would stretch itself out; and if he finally managed to do what he wanted with that leg, all the others seemed to be set free and would move about painfully. This is something that cant be done in bed, Gregor said to himself, so dont keep trying to do it.
	The first thing he wanted to do was get the lower part of his body out of the bed, but he had never seen this lower part, and could not imagine what it looked like; it turned out to be too hard to move; it went so slowly; and finally, almost in a frenzy, when he carelessly shoved himself forwards with all the force he could gather, he chose the wrong direction, hit hard against the lower bedpost, and learned from the burning pain he felt that the lower part of his body might well, at present, be the most sensitive.
	So then he tried to get the top part of his body out of the bed first, carefully turning his head to the side. This he managed quite easily, and despite its breadth and its weight, the bulk of his body eventually followed slowly in the direction of the head. But when he had at last got his head out of the bed and into the fresh air it occurred to him that if he let himself fall it would be a miracle if his head were not injured, so he became afraid to carry on pushing himself forward the same way. And he could not knock himself out now at any price; better to stay in bed than lose consciousness.
	It took just as much effort to get back to where he had been earlier, but when he lay there sighing, and was once more watching his legs as they struggled against each other even harder than before, if that was possible, he could think of no way of bringing peace and order to this chaos. He told himself once more that it was not possible for him to stay in bed and that the most sensible thing to do would be to get free of it in whatever way he could at whatever sacrifice. At the same time, though, he did not forget to remind himself that calm consideration was much better than rushing to desperate conclusions. At times like this he would direct his eyes to the window and look out as clearly as he could, but unfortunately, even the other side of the narrow street was enveloped in morning fog and the view had little confidence or cheer to offer him. Seven oclock, already, he said to himself when the clock struck again, seven oclock, and theres still a fog like this. And he lay there quietly a while longer, breathing lightly as if he perhaps expected the total stillness to bring things back to their real and natural state.
	But then he said to himself: Before it strikes quarter past seven Ill definitely have to have got properly out of bed. And by then somebody will have come round from work to ask whats happened to me as well, as they open up at work before seven oclock. And so he set himself to the task of swinging the entire length of his body out of the bed all at the same time. If he succeeded in falling out of bed in this way and kept his head raised as he did so he could probably avoid injuring it. His back seemed to be quite hard, and probably nothing would happen to it falling onto the carpet. His main concern was for the loud noise he was bound to make, and which even through all the doors would probably raise concern if not alarm. But it was something that had to be risked.
	When Gregor was already sticking half way out of the bedthe new method was more of a game than an effort, all he had to do was rock back and forthit occurred to him how simple everything would be if somebody came to help him. Two strong peoplehe had his father and the maid in mindwould have been more than enough; they would only have to push their arms under the dome of his back, peel him away from the bed, bend down with the load and then be patient and careful as he swang over onto the floor, where, hopefully, the little legs would find a use. Should he really call for help though, even apart from the fact that all the doors were locked? Despite all the difficulty he was in, he could not suppress a smile at this thought.
	After a while he had already moved so far across that it would have been hard for him to keep his balance if he rocked too hard. The time was now ten past seven and he would have to make a final decision very soon. Then there was a ring at the door of the flat. Thatll be someone from work, he said to himself, and froze very still, although his little legs only became all the more lively as they danced around. For a moment everything remained quiet. Theyre not opening the door, Gregor said to himself, caught in some nonsensical hope. But then of course, the maids firm steps went to the door as ever and opened it. Gregor only needed to hear the visitors first words of greeting and he knew who it wasthe chief clerk himself. Why did Gregor have to be the only one condemned to work for a company where they immediately became highly suspicious at the slightest shortcoming? Were all employees, every one of them, louts, was there not one of them who was faithful and devoted who would go so mad with pangs of conscience that he couldnt get out of bed if he didnt spend at least a couple of hours in the morning on company business? Was it really not enough to let one of the trainees make enquiriesassuming enquiries were even necessarydid the chief clerk have to come himself, and did they have to show the whole, innocent family that this was so suspicious that only the chief clerk could be trusted to have the wisdom to investigate it? And more because these thoughts had made him upset than through any proper decision, he swang himself with all his force out of the bed. There was a loud thump, but it wasnt really a loud noise. His fall was softened a little by the carpet, and Gregors back was also more elastic than he had thought, which made the sound muffled and not too noticeable. He had not held his head carefully enough, though, and hit it as he fell; annoyed and in pain, he turned it and rubbed it against the carpet.
	Somethings fallen down in there, said the chief clerk in the room on the left. Gregor tried to imagine whether something of the sort that had happened to him today could ever happen to the chief clerk too; you had to concede that it was possible. But as if in gruff reply to this question, the chief clerks firm footsteps in his highly polished boots could now be heard in the adjoining room. From the room on his right, Gregors sister whispered to him to let him know: Gregor, the chief clerk is here. Yes, I know, said Gregor to himself; but without daring to raise his voice loud enough for his sister to hear him.
	Gregor, said his father now from the room to his left, the chief clerk has come round and wants to know why you didnt leave on the early train. We dont know what to say to him. And anyway, he wants to speak to you personally. So please open up this door. Im sure hell be good enough to forgive the untidiness of your room. Then the chief clerk called Good morning, Mr. Samsa. He isnt well, said his mother to the chief clerk, while his father continued to speak through the door. He isnt well, please believe me. Why else would Gregor have missed a train! The lad only ever thinks about the business. It nearly makes me cross the way he never goes out in the evenings; hes been in town for a week now but stayed home every evening. He sits with us in the kitchen and just reads the paper or studies train timetables. His idea of relaxation is working with his fretsaw. Hes made a little frame, for instance, it only took him two or three evenings, youll be amazed how nice it is; its hanging up in his room; youll see it as soon as Gregor opens the door. Anyway, Im glad youre here; we wouldnt have been able to get Gregor to open the door by ourselves; hes so stubborn; and Im sure he isnt well, he said this morning that he is, but he isnt. Ill be there in a moment, said Gregor slowly and thoughtfully, but without moving so that he would not miss any word of the conversation. Well I cant think of any other way of explaining it, Mrs. Samsa, said the chief clerk, I hope its nothing serious. But on the other hand, I must say that if we people in commerce ever become slightly unwell then, fortunately or unfortunately as you like, we simply have to overcome it because of business considerations. Can the chief clerk come in to see you now then?, asked his father impatiently, knocking at the door again. No, said Gregor. In the room on his right there followed a painful silence; in the room on his left his sister began to cry.
	So why did his sister not go and join the others? She had probably only just got up and had not even begun to get dressed. And why was she crying? Was it because he had not got up, and had not let the chief clerk in, because he was in danger of losing his job and if that happened his boss would once more pursue their parents with the same demands as before? There was no need to worry about things like that yet. Gregor was still there and had not the slightest intention of abandoning his family. For the time being he just lay there on the carpet, and no-one who knew the condition he was in would seriously have expected him to let the chief clerk in. It was only a minor discourtesy, and a suitable excuse could easily be found for it later on, it was not something for which Gregor could be sacked on the spot. And it seemed to Gregor much more sensible to leave him now in peace instead of disturbing him with talking at him and crying. But the others didnt know what was happening, they were worried, that would excuse their behaviour.
	The chief clerk now raised his voice, Mr. Samsa, he called to him, what is wrong? You barricade yourself in your room, give us no more than yes or no for an answer, you are causing serious and unnecessary concern to your parents and you failand I mention this just by the wayyou fail to carry out your business duties in a way that is quite unheard of. Im speaking here on behalf of your parents and of your employer, and really must request a clear and immediate explanation. I am astonished, quite astonished. I thought I knew you as a calm and sensible person, and now you suddenly seem to be showing off with peculiar whims. This morning, your employer did suggest a possible reason for your failure to appear, its trueit had to do with the money that was recently entrusted to youbut I came near to giving him my word of honour that that could not be the right explanation. But now that I see your incomprehensible stubbornness I no longer feel any wish whatsoever to intercede on your behalf. And nor is your position all that secure. I had originally intended to say all this to you in private, but since you cause me to waste my time here for no good reason I dont see why your parents should not also learn of it. Your turnover has been very unsatisfactory of late; I grant you that its not the time of year to do especially good business, we recognise that; but there simply is no time of year to do no business at all, Mr. Samsa, we cannot allow there to be.
	But Sir, called Gregor, beside himself and forgetting all else in the excitement, Ill open up immediately, just a moment. Im slightly unwell, an attack of dizziness, I havent been able to get up. Im still in bed now. Im quite fresh again now, though. Im just getting out of bed. Just a moment. Be patient! Its not quite as easy as Id thought. Im quite alright now, though. Its shocking, what can suddenly happen to a person! I was quite alright last night, my parents know about it, perhaps better than me, I had a small symptom of it last night already. They must have noticed it. I dont know why I didnt let you know at work! But you always think you can get over an illness without staying at home. Please, dont make my parents suffer! Theres no basis for any of the accusations youre making; nobodys ever said a word to me about any of these things. Maybe you havent read the latest contracts I sent in. Ill set off with the eight oclock train, as well, these few hours of rest have given me strength. You dont need to wait, sir; Ill be in the office soon after you, and please be so good as to tell that to the boss and recommend me to him!
	And while Gregor gushed out these words, hardly knowing what he was saying, he made his way over to the chest of drawersthis was easily done, probably because of the practise he had already had in bedwhere he now tried to get himself upright. He really did want to open the door, really did want to let them see him and to speak with the chief clerk; the others were being so insistent, and he was curious to learn what they would say when they caught sight of him. If they were shocked then it would no longer be Gregors responsibility and he could rest. If, however, they took everything calmly he would still have no reason to be upset, and if he hurried he really could be at the station for eight oclock. The first few times he tried to climb up on the smooth chest of drawers he just slid down again, but he finally gave himself one last swing and stood there upright; the lower part of his body was in serious pain but he no longer gave any attention to it. Now he let himself fall against the back of a nearby chair and held tightly to the edges of it with his little legs. By now he had also calmed down, and kept quiet so that he could listen to what the chief clerk was saying.
	Did you understand a word of all that? the chief clerk asked his parents, surely hes not trying to make fools of us. Oh, God! called his mother, who was already in tears, he could be seriously ill and were making him suffer. Grete! Grete! she then cried. Mother? his sister called from the other side. They communicated across Gregors room. Youll have to go for the doctor straight away. Gregor is ill. Quick, get the doctor. Did you hear the way Gregor spoke just now? That was the voice of an animal, said the chief clerk, with a calmness that was in contrast with his mothers screams. Anna! Anna! his father called into the kitchen through the entrance hall, clapping his hands, get a locksmith here, now! And the two girls, their skirts swishing, immediately ran out through the hall, wrenching open the front door of the flat as they went. How had his sister managed to get dressed so quickly? There was no sound of the door banging shut again; they must have left it open; people often do in homes where something awful has happened.
	Gregor, in contrast, had become much calmer. So they couldnt understand his words any more, although they seemed clear enough to him, clearer than beforeperhaps his ears had become used to the sound. They had realised, though, that there was something wrong with him, and were ready to help. The first response to his situation had been confident and wise, and that made him feel better. He felt that he had been drawn back in among people, and from the doctor and the locksmith he expected great and surprising achievementsalthough he did not really distinguish one from the other. Whatever was said next would be crucial, so, in order to make his voice as clear as possible, he coughed a little, but taking care to do this not too loudly as even this might well sound different from the way that a human coughs and he was no longer sure he could judge this for himself. Meanwhile, it had become very quiet in the next room. Perhaps his parents were sat at the table whispering with the chief clerk, or perhaps they were all pressed against the door and listening.
	Gregor slowly pushed his way over to the door with the chair. Once there he let go of it and threw himself onto the door, holding himself upright against it using the adhesive on the tips of his legs. He rested there a little while to recover from the effort involved and then set himself to the task of turning the key in the lock with his mouth. He seemed, unfortunately, to have no proper teethhow was he, then, to grasp the key?but the lack of teeth was, of course, made up for with a very strong jaw; using the jaw, he really was able to start the key turning, ignoring the fact that he must have been causing some kind of damage as a brown fluid came from his mouth, flowed over the key and dripped onto the floor. Listen, said the chief clerk in the next room, hes turning the key. Gregor was greatly encouraged by this; but they all should have been calling to him, his father and his mother too: Well done, Gregor, they should have cried, keep at it, keep hold of the lock! And with the idea that they were all excitedly following his efforts, he bit on the key with all his strength, paying no attention to the pain he was causing himself. As the key turned round he turned around the lock with it, only holding himself upright with his mouth, and hung onto the key or pushed it down again with the whole weight of his body as needed. The clear sound of the lock as it snapped back was Gregors sign that he could break his concentration, and as he regained his breath he said to himself: So, I didnt need the locksmith after all. Then he lay his head on the handle of the door to open it completely.
	Because he had to open the door in this way, it was already wide open before he could be seen. He had first to slowly turn himself around one of the double doors, and he had to do it very carefully if he did not want to fall flat on his back before entering the room. He was still occupied with this difficult movement, unable to pay attention to anything else, when he heard the chief clerk exclaim a loud Oh!, which sounded like the soughing of the wind. Now he also saw himhe was the nearest to the doorhis hand pressed against his open mouth and slowly retreating as if driven by a steady and invisible force. Gregors mother, her hair still dishevelled from bed despite the chief clerks being there, looked at his father. Then she unfolded her arms, took two steps forward towards Gregor and sank down onto the floor into her skirts that spread themselves out around her as her head disappeared down onto her breast. His father looked hostile, and clenched his fists as if wanting to knock Gregor back into his room. Then he looked uncertainly round the living room, covered his eyes with his hands and wept so that his powerful chest shook.
	So Gregor did not go into the room, but leant against the inside of the other door which was still held bolted in place. In this way only half of his body could be seen, along with his head above it which he leant over to one side as he peered out at the others. Meanwhile the day had become much lighter; part of the endless, grey-black building on the other side of the streetwhich was a hospitalcould be seen quite clearly with the austere and regular line of windows piercing its faade; the rain was still falling, now throwing down large, individual droplets which hit the ground one at a time. The washing up from breakfast lay on the table; there was so much of it because, for Gregors father, breakfast was the most important meal of the day and he would stretch it out for several hours as he sat reading a number of different newspapers. On the wall exactly opposite there was photograph of Gregor when he was a lieutenant in the army, his sword in his hand and a carefree smile on his face as he called forth respect for his uniform and bearing. The door to the entrance hall was open and as the front door of the flat was also open he could see onto the landing and the stairs where they began their way down below.
	Now, then, said Gregor, well aware that he was the only one to have kept calm, Ill get dressed straight away now, pack up my samples and set off. Will you please just let me leave? You can see, he said to the chief clerk, that Im not stubborn and I like to do my job; being a commercial traveller is arduous but without travelling I couldnt earn my living. So where are you going, in to the office? Yes? Will you report everything accurately, then? Its quite possible for someone to be temporarily unable to work, but thats just the right time to remember whats been achieved in the past and consider that later on, once the difficulty has been removed, he will certainly work with all the more diligence and concentration. Youre well aware that Im seriously in debt to our employer as well as having to look after my parents and my sister, so that Im trapped in a difficult situation, but I will work my way out of it again. Please dont make things any harder for me than they are already, and dont take sides against me at the office. I know that nobody likes the travellers. They think we earn an enormous wage as well as having a soft time of it. Thats just prejudice but they have no particular reason to think better of it. But you, sir, you have a better overview than the rest of the staff, in fact, if I can say this in confidence, a better overview than the boss himselfits very easy for a businessman like him to make mistakes about his employees and judge them more harshly than he should. And youre also well aware that we travellers spend almost the whole year away from the office, so that we can very easily fall victim to gossip and chance and groundless complaints, and its almost impossible to defend yourself from that sort of thing, we dont usually even hear about them, or if at all its when we arrive back home exhausted from a trip, and thats when we feel the harmful effects of whats been going on without even knowing what caused them. Please, dont go away, at least first say something to show that you grant that Im at least partly right!
	But the chief clerk had turned away as soon as Gregor had started to speak, and, with protruding lips, only stared back at him over his trembling shoulders as he left. He did not keep still for a moment while Gregor was speaking, but moved steadily towards the door without taking his eyes off him. He moved very gradually, as if there had been some secret prohibition on leaving the room. It was only when he had reached the entrance hall that he made a sudden movement, drew his foot from the living room, and rushed forward in a panic. In the hall, he stretched his right hand far out towards the stairway as if out there, there were some supernatural force waiting to save him.
	Gregor realised that it was out of the question to let the chief clerk go away in this mood if his position in the firm was not to be put into extreme danger. That was something his parents did not understand very well; over the years, they had become convinced that this job would provide for Gregor for his entire life, and besides, they had so much to worry about at present that they had lost sight of any thought for the future. Gregor, though, did think about the future. The chief clerk had to be held back, calmed down, convinced and finally won over; the future of Gregor and his family depended on it! If only his sister were here! She was clever; she was already in tears while Gregor was still lying peacefully on his back. And the chief clerk was a lover of women, surely she could persuade him; she would close the front door in the entrance hall and talk him out of his shocked`;

        // --- Global State and Element References ---
        let currentRouteStep = 0;
        let linkClickCounter = 0; // NEW: Counter for any link clicks
        const secretRoutes = {
            'story-route': { // Renamed from original 'story' destination to 'story-only'
                sequence: ["yes", "no", "the truth is out there."],
                destination: 'story-only'
            },
            'metamorphosis-route': { // Renamed from oracle-route and changed destination
                sequence: ["you woke up a cockroach and your family betrayed you"],
                destination: 'metamorphosis-page'
            },
            'shapes-route': { // NEW: Secret route for shapes-only page
                sequence: ["process", "decay", "fragment"],
                destination: 'shapes-only'
            },
            'infinite-scroll-route': { // NEW: Secret route for infinite scroll
                sequence: ["stasis", "void", "calculate"],
                destination: 'infinite-scroll'
            },
            'random-text-route': { // NEW: Secret route for random text page
                sequence: ["error", "reboot", "wait"],
                destination: 'random-text-page'
            },
            'jesus-portfolio-route': { // Reverted to original three-step sequence
                sequence: ["heaven is empty", "this_is_gods_work", "bydesign, you were createdin(gods image)"],
                destination: 'jesus-portfolio'
            },
            'download-route': { // NEW: Secret route for download page
                sequence: ["process", "download", "complete"],
                destination: 'download-page'
            },
            'garbage-house-route': { // Already existing route
                sequence: ["alone in all this mess", "alone in all this mess", "alone in all this mess"],
                destination: 'garbage-house-page'
            },
            'giant-wall-route': { // NEW: Secret route for 10 clicks
                sequence: ["_trigger_giant_wall_"], // Placeholder to signify this is a click-count trigger
                destination: 'giant-wall-of-text-page'
            }
        };
        let activeRouteKey = null;
        let currentSecretGatewayWord = null;

        const seizureWarningOverlay = document.getElementById('seizure-warning-overlay');
        const mainContent = document.getElementById('main-content');
        const mainPageElements = document.getElementById('main-page-elements');
        const linksContainer = document.getElementById('links-container');
        const byGabrielText = document.getElementById('by-gabriel');
        const randomHeader = document.getElementById('random-header');

        const staticVoidPageDiv = document.getElementById('static-void-page');
        const infiniteScrollPageDiv = document.getElementById('infinite-scroll-page');
        const storyOnlyPageDiv = document.getElementById('story-only-page');
        const oraclePageDiv = document.getElementById('oracle-page'); // Oracle page still exists, just its trigger changed
        const randomTextPageDiv = document.getElementById('random-text-page');
        const shapesOnlyPageDiv = document.getElementById('shapes-only-page');
        const jesusPortfolioPageDiv = document.getElementById('jesus-portfolio-page');
        const downloadPageDiv = document.getElementById('download-page');
        const garbageHousePageDiv = document.getElementById('garbage-house-page');
        const metamorphosisPageDiv = document.getElementById('metamorphosis-page'); // NEW
        const giantWallOfTextPageDiv = document.getElementById('giant-wall-of-text-page'); // NEW
        const thomYorkePageDiv = document.getElementById('thom-yorke-page'); // NEW
        const leavePageDiv = document.getElementById('leave-page'); // NEW
        const webpageHubPageDiv = document.getElementById('webpage-hub-page'); // NEW
        const dynamicContentPageDiv = document.getElementById('dynamic-content-page'); // NEW

        const redSquare = document.getElementById('red-square');
        const blueSquare = document.getElementById('blue-square');
        const imagePopup = document.getElementById('image-popup');
        const imagePopupImg = imagePopup.querySelector('img');

        let flashingInterval = null;
        let colorSquareTimeout = null;
        let imageScheduleInterval = null;
        let randomTextPageInterval = null;
        let staticVoidFlashingInterval = null;
        let purpleTriangleInterval = null;
        let storyOnlyFlashingInterval = null;
        let garbageHousePurpleTriangleInterval = null;
        let garbageHouseImageInterval = null;
        let metamorphosisPurpleTriangleInterval = null; // NEW
        let metamorphosisImageInterval = null; // NEW
        let numberedRandomStringImageInterval = null; // NEW

        let infiniteScrollListenerAttached = false;
        let glitchHeaderInterval = null;
        let glitchByGabrielInterval = null;

        // Tone.js audio setup
        let ambientNoise = null;
        let clickSynth = null;
        let isAudioInitialized = false;

        // --- Utility Functions ---
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateRandomString(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            let result = '';
            const charactersLength = characters.length;
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            return result;
        }

        // Function to generate small, repeating Calibri headers
        function generateRepeatingCalibriHeader(baseText, numRepeats = 5) {
            const separator = getRandomInt(0, 1) === 0 ? ' . ' : ' _ '; // Random separator
            let repeatedText = '';
            for (let i = 0; i < numRepeats; i++) {
                repeatedText += baseText;
                if (i < numRepeats - 1) {
                    repeatedText += separator;
                }
            }
            return repeatedText.toLowerCase(); // Ensure lowercase
        }

        // --- Audio Functions ---
        function initAudio() {
            if (isAudioInitialized) return;

            // Ambient Static/Hum
            ambientNoise = new Tone.Noise('white').toDestination();
            ambientNoise.volume.value = -30; // Very quiet
            ambientNoise.loop = true;
            ambientNoise.fadeIn = 0.5; // Small fade in to prevent harsh start
            ambientNoise.start();

            // Click/Glitch Sound
            clickSynth = new Tone.NoiseSynth({
                noise: {
                    type: 'white',
                    playbackRate: 0.8
                },
                envelope: {
                    attack: 0.001,
                    decay: 0.05,
                    sustain: 0.001,
                    release: 0.05,
                    amplitude: 1
                }
            }).toDestination();
            clickSynth.volume.value = -15; // Set a reasonable volume for clicks

            isAudioInitialized = true;
        }

        function playClickSound() {
            if (clickSynth) {
                clickSynth.triggerAttackRelease(0.1); // Play a quick sound
            }
        }

        // --- Page Management Functions ---

        // General function to stop all continuous visual effects
        function stopAllPageEffects() {
            if (flashingInterval) clearInterval(flashingInterval);
            if (colorSquareTimeout) clearTimeout(colorSquareTimeout);
            if (imageScheduleInterval) clearInterval(imageScheduleInterval);
            if (randomTextPageInterval) clearInterval(randomTextPageInterval);
            if (staticVoidFlashingInterval) clearInterval(staticVoidFlashingInterval);
            if (purpleTriangleInterval) clearInterval(purpleTriangleInterval);
            if (storyOnlyFlashingInterval) clearInterval(storyOnlyFlashingInterval);
            if (glitchHeaderInterval) clearInterval(glitchHeaderInterval); // Stop header glitch
            if (glitchByGabrielInterval) clearInterval(glitchByGabrielInterval); // Stop by gabriel glitch
            if (garbageHousePurpleTriangleInterval) clearInterval(garbageHousePurpleTriangleInterval);
            if (garbageHouseImageInterval) clearInterval(garbageHouseImageInterval);
            if (metamorphosisPurpleTriangleInterval) clearInterval(metamorphosisPurpleTriangleInterval); // NEW
            if (metamorphosisImageInterval) clearInterval(metamorphosisImageInterval); // NEW
            if (numberedRandomStringImageInterval) clearInterval(numberedRandomStringImageInterval); // NEW

            flashingInterval = null; // Reset intervals
            colorSquareTimeout = null;
            imageScheduleInterval = null;
            randomTextPageInterval = null;
            staticVoidFlashingInterval = null;
            purpleTriangleInterval = null;
            storyOnlyFlashingInterval = null;
            glitchHeaderInterval = null;
            glitchByGabrielInterval = null;
            garbageHousePurpleTriangleInterval = null;
            garbageHouseImageInterval = null;
            metamorphosisPurpleTriangleInterval = null; // NEW
            metamorphosisImageInterval = null; // NEW
            numberedRandomStringImageInterval = null; // NEW


            // Hide main page visual pop-ups (red/blue squares, images)
            redSquare.style.display = 'none';
            blueSquare.style.display = 'none';
            imagePopup.style.display = 'none';

            // Ensure default body styles are applied
            document.body.style.backgroundColor = defaultBg;
            document.body.style.color = defaultText;
            document.body.style.opacity = 1; // Reset opacity
        }

        // General function to restart main page specific effects
        function startMainPageEffects() {
            initiateFlashing();
            scheduleColorSquares();
            scheduleRandomImages();
            startHeaderGlitch();
            startByGabrielGlitch();
        }

        // Function to hide all "full-page-container" divs
        function hideAllFullPages() {
            const pages = [mainPageElements, staticVoidPageDiv, infiniteScrollPageDiv, storyOnlyPageDiv, oraclePageDiv, randomTextPageDiv, shapesOnlyPageDiv, jesusPortfolioPageDiv, downloadPageDiv, garbageHousePageDiv, metamorphosisPageDiv, giantWallOfTextPageDiv, thomYorkePageDiv, leavePageDiv, webpageHubPageDiv, dynamicContentPageDiv]; // Updated list
            pages.forEach(page => page.classList.add('hidden'));
        }

        // Go back to the main page from any sub-page
        function goBackToMainPage() {
            stopAllPageEffects(); // Stop effects from the page being exited
            hideAllFullPages(); // Hide all current pages

            mainPageElements.classList.remove('hidden'); // Show main links page
            currentSecretGatewayWord = linkCorpus[getRandomInt(0, linkCorpus.length - 1)]; // Select new word for main page
            generateRandomLinks(); // Regenerate links with the new word

            startMainPageEffects(); // Restart main page effects
            document.body.style.overflow = 'hidden'; // Restore main body overflow behavior
            document.body.style.backgroundColor = defaultBg; // Ensure body background is default
            document.body.style.color = defaultText; // Ensure body text color is default
        }

        // --- Page Content & HTML Injection Functions ---

        function setupStoryOnlyPage() {
            storyOnlyPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="story-content-area" class="text-center w-full max-w-2xl mx-auto"></div>
            `;
            storyOnlyPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("story . of . us", getRandomInt(3,7));
            storyOnlyPageDiv.querySelector('#story-content-area').innerHTML = `<p>${storyContent.replace(/\n/g, '<br><br>').toLowerCase()}</p>`;
            
            startStoryOnlyFlashing();
        }

        function setupOraclePage() {
            oraclePageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="oracle-content-area" class="w-full"></div>
            `;
            oraclePageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("signals . from . the . void");
            oraclePageDiv.querySelector('#oracle-content-area').innerHTML = `
                <p class="oracle-explanation">. . . t r a n s m i t . q u e r y . . .</p>
                <div class="llm-input-area">
                    <input type="text" id="oracle-query" placeholder="enter data packet here..." />
                    <button id="oracle-consult-button">t r a n s m i t</button>
                    <div id="oracle-loading">. . . e m a n a t i n g . . .</div>
                </div>
                <pre id="oracle-response" class="" style="font-weight: normal;"></pre>
            `;
            attachOracleListeners();
        }

        function setupRandomTextPage() {
            randomTextPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="random-text-content-area" class="w-full"></div>
            `;
            randomTextPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("random . data . stream");
            let popupContentText = '';
            const numPhrases = getRandomInt(20, 40);
            for(let i = 0; i < numPhrases; i++) {
                const randomIndex = getRandomInt(0, oracleResponses.length - 1);
                popupContentText += oracleResponses[randomIndex].toLowerCase();
                if (Math.random() < 0.2) {
                    popupContentText += generateRandomString(getRandomInt(1, 3));
                }
                if (i < numPhrases - 1) {
                    popupContentText += getRandomInt(0, 1) === 0 ? ' ' : (getRandomInt(0, 1) === 0 ? '. ' : ', ');
                }
            }
            randomTextPageDiv.querySelector('#random-text-content-area').innerHTML = `<p class="random-content-block">${popupContentText}</p>`;
        }

        function setupStaticVoidPage() {
            staticVoidPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="static-void-text-container"></div>
                <div id="static-void-image-container"></div>
            `;
            staticVoidPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("static . void . gallery");
            staticVoidPageDiv.querySelector('#static-void-text-container').textContent = `
                ${generateRandomString(getRandomInt(50, 150))}
                00101010101010101010101010101
                ${generateRandomString(getRandomInt(30, 80))}
                corrupted . packet . detected .
                ${linkCorpus.filter(text => text.length > 20).map(text => text.toLowerCase()).join(' . . . ')}
                signal loss. no trace.
                ${oracleResponses.map(r => r.toLowerCase()).join(' +++ ')}
                the void. accelerating.
                lost connection.
                static. no. always watching.
                ${generateRandomString(getRandomInt(100, 200))}
            `.toLowerCase();
            
            startStaticVoidFlashes();
            startPurpleTriangles(staticVoidPageDiv, 'purple-triangle'); // Pass the parent and class
            addRandomStaticVoidImages(staticVoidPageDiv); // Pass the parent
        }

        function setupInfiniteScrollPage() {
            infiniteScrollPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="infinite-scroll-content" class="text-black" style="padding-bottom: 50px;"></div>
            `;
            infiniteScrollPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("infinite . repetition");
            const infiniteScrollContent = document.getElementById('infinite-scroll-content');
            
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('p');
                p.classList.add('repeating-block');
                p.textContent = infiniteScrollMessage.toLowerCase();
                infiniteScrollContent.appendChild(p);
            }

            if (!infiniteScrollListenerAttached) {
                infiniteScrollPageDiv.addEventListener('scroll', () => {
                    const { scrollTop, scrollHeight, clientHeight } = infiniteScrollPageDiv;
                    if (scrollTop + clientHeight >= scrollHeight - 200) {
                        for (let i = 0; i < 10; i++) {
                            const p = document.createElement('p');
                            p.classList.add('repeating-block');
                            p.textContent = infiniteScrollMessage.toLowerCase();
                            infiniteScrollContent.appendChild(p);
                        }
                    }
                });
                infiniteScrollListenerAttached = true;
            }
        }

        function setupShapesOnlyPage() {
            shapesOnlyPageDiv.innerHTML = `
                <!-- No header here, as requested for starkness -->
            `;
            document.body.style.backgroundColor = '#FFFFFF';
            document.body.style.color = '#000000';

            scheduleColorSquares();
            scheduleRandomImages();
        }

        function setupJesusPortfolioPage() {
            jesusPortfolioPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="portfolio-content-area">
                    <div class="portfolio-image-container">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ157sJe6XhVl2OtLXLKKUQ93KVHeVRGiRZpQ&s" alt="Jesus' Portfolio Image">
                    </div>
                    <p class="portfolio-text-content"></p>
                </div>
            `;
            jesusPortfolioPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("jesus' portfolio . my . creations");
            const portfolioText = `stories, ideas, idea, kindness, karma. all to bare. get up off your feet and get into your spirituality. eulogy, momity. ghost walking. welcome to my portfolio. i love it, you love it. we all love it. i'll skin you alive. we eat frogs. this website is fun. the best on the web. you agree with me. i'll skin you alive. stories. thecreature. creature stories. youagree with me. i'll skin you alive. i will knife you where you stand. hehehe. ghost walking. we eat frogs. have you met oracle yet? have you? he's a funny guy. try saying stuff to him. built on top of the line ai systems? the true reality speaks. he speaks for the universe -- i do, too. my portfolio. hope you love it. i'll knife you.`;
            jesusPortfolioPageDiv.querySelector('.portfolio-text-content').textContent = portfolioText;

            document.body.style.overflow = 'auto';
            document.body.style.backgroundColor = '#E0E0E0';
            document.body.style.color = '#000000';
        }

        function setupDownloadPage() {
            downloadPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <ul id="download-file-list">
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: corrupted_log.bin'); showMessage('Download initiated: corrupted_log.bin');">corrupted_log.bin</a><span class="file-size">1.2 MB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: fragment_001.dat'); showMessage('Download initiated: fragment_001.dat');">fragment_001.dat</a><span class="file-size">5.7 KB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: unknown_protocol.zip'); showMessage('Download initiated: unknown_protocol.zip');">unknown_protocol.zip</a><span class="file-size">8.9 MB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: manifest.txt'); showMessage('Download initiated: manifest.txt');">manifest.txt</a><span class="file-size">0.1 MB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: trace_dump_2004.log'); showMessage('Download initiated: trace_dump_2004.log');">trace_dump_2004.log</a><span class="file-size">2.3 GB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: system_error_report.doc'); showMessage('Download initiated: system_error_report.doc');">system_error_report.doc</a><span class="file-size">76 KB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: black_box_record.wav'); showMessage('Download initiated: black_box_record.wav');">black_box_record.wav</a><span class="file-size">14.5 MB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: consciousness_map.bin'); showMessage('Download initiated: consciousness_map.bin');">consciousness_map.bin</a><span class="file-size">4.0 GB</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: temporal_anomaly_data.enc'); showMessage('Download initiated: temporal_anomaly_data.enc');">temporal_anomaly_data.enc</a><span class="file-size">987 Bytes</span></li>
                    <li><a href="javascript:void(0);" onclick="console.log('File download initiated: forgotten_dreams.iso'); showMessage('Download initiated: forgotten_dreams.iso');">forgotten_dreams.iso</a><span class="file-size">3.7 GB</span></li>
                </ul>
            `;
            downloadPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("data . streams . awaiting . transfer");
            document.body.style.overflow = 'auto';
            document.body.style.backgroundColor = '#DDDDDD';
            document.body.style.color = '#000000';
            function showMessage(message) {
                const existingMsg = document.getElementById('custom-message-box');
                if (existingMsg) existingMsg.remove();

                const msgBox = document.createElement('div');
                msgBox.id = 'custom-message-box';
                msgBox.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background-color: #333;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 5px;
                    font-family: 'Arial', sans-serif;
                    font-size: 0.9em;
                    z-index: 10000;
                    opacity: 0.9;
                    box-shadow: 0 0 10px rgba(0,0,0,0.5);
                    display: flex;
                    align-items: center;
                `;
                msgBox.textContent = message;

                const closeButton = document.createElement('button');
                closeButton.textContent = 'X';
                closeButton.style.cssText = `
                    background: none;
                    border: none;
                    color: white;
                    font-size: 1.2em;
                    margin-left: 10px;
                    cursor: pointer;
                `;
                closeButton.onclick = () => msgBox.remove();
                msgBox.appendChild(closeButton);

                document.body.appendChild(msgBox);

                setTimeout(() => {
                    if (msgBox.parentNode) {
                        msgBox.remove();
                    }
                }, 3000);
            }
            window.showMessage = showMessage;
        }

        // Garbage House Page Setup
        function setupGarbageHousePage() {
            garbageHousePageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="garbage-house-text-content" class="garbage-text-content"></div>
                <div id="garbage-house-image-container"></div>
            `;
            garbageHousePageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("garbage . house . interior . report");

            const textToRender = "I went into a garbage house with 6 floors. Each floor was colourful and lovely and imagelike. I love my mother And I love sharks. Each floor had a shark and a potted plant. I love jebus. Where are you Jebus!! Woo-hoo! Each floor had a rubber duck except for the second. Harold Looked at me with surprise.";
            const words = textToRender.split(/(\s+|[.,!?;:]+)/).filter(word => word.trim() !== ''); // Split by space and keep punctuation

            const textContainer = document.getElementById('garbage-house-text-content');
            const fonts = ['font-arial', 'font-verdana', 'font-courier', 'font-georgia', 'font-times'];
            const colors = ['color-red', 'color-blue', 'color-green', 'color-purple', 'color-orange', 'color-darkgray', 'color-black'];

            words.forEach(word => {
                const span = document.createElement('span');
                span.textContent = word;

                // Apply random font
                span.classList.add(fonts[getRandomInt(0, fonts.length - 1)]);
                
                // Apply random color (not black or darkgray too often)
                let randomColorClass = colors[getRandomInt(0, colors.length - 1)];
                while (Math.random() < 0.3 && (randomColorClass === 'color-black' || randomColorClass === 'color-darkgray')) {
                     randomColorClass = colors[getRandomInt(0, colors.length - 1)];
                }
                span.classList.add(randomColorClass);

                // Occasionally change font size slightly
                if (Math.random() < 0.2) {
                    span.style.fontSize = `${getRandomInt(90, 130)}%`; // Vary by percentage
                }

                textContainer.appendChild(span);
            });

            document.body.style.overflow = 'auto'; // Allow scrolling
            document.body.style.backgroundColor = '#F0F0F0';
            document.body.style.color = '#000000'; // Default black for readability with varying colors

            startPurpleTriangles(garbageHousePageDiv, 'purple-triangle'); // Start triangles for this page
            addRandomGarbageHouseImages(); // Add images for this page
        }

        // NEW: Metamorphosis Page Setup
        function setupMetamorphosisPage() {
            metamorphosisPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div id="metamorphosis-text-content" class="metamorphosis-text-content"></div>
                <div id="metamorphosis-image-container"></div>
            `;
            metamorphosisPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("transformation . report . protocol");

            const textToRender = metamorphosisText;
            const words = textToRender.split(/(\s+|[.,!?;:]+)/).filter(word => word.trim() !== ''); // Split by space and keep punctuation

            const textContainer = document.getElementById('metamorphosis-text-content');
            const fonts = ['font-arial', 'font-verdana', 'font-courier', 'font-georgia', 'font-times'];
            const colors = ['color-red', 'color-blue', 'color-green', 'color-purple', 'color-orange', 'color-darkgray', 'color-black'];

            words.forEach(word => {
                const span = document.createElement('span');
                span.textContent = word;

                // Apply random font
                span.classList.add(fonts[getRandomInt(0, fonts.length - 1)]);
                
                // Apply random color
                span.classList.add(colors[getRandomInt(0, colors.length - 1)]);

                // Occasionally change font size
                if (Math.random() < 0.25) { // Higher chance for size variation
                    span.style.fontSize = `${getRandomInt(80, 150)}%`; // Wider range for size variation
                }
                // Occasionally make bold or italic
                if (Math.random() < 0.1) {
                    span.style.fontWeight = 'bold';
                }
                if (Math.random() < 0.1) {
                    span.style.fontStyle = 'italic';
                }

                textContainer.appendChild(span);
            });

            document.body.style.overflow = 'auto';
            document.body.style.backgroundColor = '#CCCCCC'; // Specific background for this page
            document.body.style.color = '#000000'; // Ensure readability

            startPurpleTriangles(metamorphosisPageDiv, 'purple-triangle'); // Start triangles for this page
            addRandomMetamorphosisImages(); // Add images for this page
        }

        // NEW: Giant Wall of Text Page Setup
        function setupGiantWallOfTextPage() {
            giantWallOfTextPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="content-wrapper">
                    <p id="giant-text-content"></p>
                    <div class="navigation-options">
                        <button id="return-to-main">Return to Main Page</button>
                        <button id="go-to-thom-yorke">Page 1: Hello There, NEwYourk.</button>
                        <button id="go-to-leave-page">Page 2: Leave</button>
                    </div>
                </div>
            `;
            giantWallOfTextPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("the . truth . revealed");

            const giantText = `John J Cena told me that Matt Graning A fisher man was in Charge of the world. Every one loves Matt Groening!! He made hit show Futurama, how lovely. To Think I've conjured all this. I've met so many people, Daisy!! (Daisy Is my wife) And Uh I think you'd love them. Someone telll them to GET OFF MY CASE and Please (Certiany) Please, Please, Please GET OFF MY CASE!! The feds are on me, The PoPo. Um, I cant believe this. I love bananas And Whitney Ashley. Whitney Ashley is a forgotten A-List celebrity, anyone Who has money is On the Eipstein Files except for her. I love her and Jack Black, A nother A-List celebrity. They have HEART. They arent on the Kid Toucher's list. IPOPOPOPO. ACAB, NOT REALLY!! Some are, Some are, I get it. Police Brutality!! Loving Me, Loving You. Signed, Your BEst friend. But I'm not done, no no no no no. Click me! Click me! Click me!`;
            giantWallOfTextPageDiv.querySelector('#giant-text-content').textContent = giantText;

            // Add event listeners for the navigation options
            giantWallOfTextPageDiv.querySelector('#return-to-main').addEventListener('click', () => {
                playClickSound();
                goBackToMainPage();
            });
            giantWallOfTextPageDiv.querySelector('#go-to-thom-yorke').addEventListener('click', () => {
                playClickSound();
                showContentByType('thom-yorke-page');
            });
            giantWallOfTextPageDiv.querySelector('#go-to-leave-page').addEventListener('click', () => {
                playClickSound();
                showContentByType('leave-page');
            });

            document.body.style.overflow = 'auto'; // Allow scrolling for this giant text
            document.body.style.backgroundColor = '#DDDDDD';
            document.body.style.color = '#000000';
        }

        // NEW: Thom Yorke Page Setup
        function setupThomYorkePage() {
            thomYorkePageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="content-wrapper"></div>
            `;
            thomYorkePageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("an . ode . to . the . masters");

            const thomYorkeText = `This is an ODE to Thom Yorke, Jonny Greenwood, Colin Greenwood, Ed O'Brien and Philip Selway! I LOOVE your Work. Every single one of you ARE AWESOME!! YOu inspired me to get Into lyric writing. How wonderful. Remember when you set tripwires up to shoot ME in the neck. BUT Philip Selway decided it wassnt Worth it anymore. Not anymore. You told me to GET OFF YOUR CASE. I'll TEll your fans I'm Only kidding. Hahaha! So, So So. You are My favorite person, I ate KFC with you and that was only the beginning to a thirty Year Friendship. Time moves too fast. I ate a Banana with you in the house of common. S. I hate that moment. The time you, yes YOUU. Made me drink a gallon of expired milk and wash it down with a gallon of bleach and a Wendy's Cheeseburger. Wendy's Cheeser. You know why You are here. You want me to do it again. AFTER ALL THE THINGS I DID FOR YOU! Ed O Brien, I love you, You did Nothing wrong. Colin, Colin Colin. Why and Where WERE YOU!! I DONT KNOW YOU ANYMORE!! CILIN KOLIN COLIN!!! COLIN!! COLIN!! COLIN!! YOU made me Juxtapose Whitney Ashley. Whitney Houston. I Love You. HOw to dissapear completely. You made me eat a bottle of Laxatives, Jonny Greenwood. Your Wood is ACTUALLY GREEN!! Thats how YOU, yes YOU got YOUR last name!! IN the house of common S. Hate Jao. JAWNFDFJI.`;
            thomYorkePageDiv.querySelector('.content-wrapper').textContent = thomYorkeText;

            // Apply specific styles
            thomYorkePageDiv.style.backgroundColor = '#FF69B4'; // Bright Pink
            thomYorkePageDiv.style.color = '#000000'; // Black text
            thomYorkePageDiv.style.fontFamily = "'Times New Roman', serif";
            thomYorkePageDiv.querySelector('.content-wrapper').style.fontWeight = 'bold';
            thomYorkePageDiv.querySelector('.content-wrapper').style.fontSize = 'clamp(2rem, 10vw, 5rem)';
            thomYorkePageDiv.style.lineHeight = '1'; // Tight line height for big text
            thomYorkePageDiv.style.textAlign = 'center'; // Center the content
            thomYorkePageDiv.style.justifyContent = 'center';
            thomYorkePageDiv.style.alignItems = 'center';
            
            document.body.style.overflow = 'auto'; // Allow scrolling if text overflows
            document.body.style.backgroundColor = '#FF69B4'; // Ensure body matches
            document.body.style.color = '#000000';
        }

        // NEW: Leave Page Setup
        function setupLeavePage() {
            leavePageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="repeating-leave"></div>
            `;
            leavePageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("exit . protocol . initiated");

            const repeatingTextContent = "leave "; // Text to repeat

            const contentWrapper = leavePageDiv.querySelector('.repeating-leave');
            let fullText = '';
            // Repeat 'leave ' multiple times to fill a significant area
            for (let i = 0; i < 500; i++) { // Adjusted repetition count to make it fill the screen
                fullText += repeatingTextContent;
            }
            contentWrapper.textContent = fullText;

            // Apply specific styles
            leavePageDiv.style.backgroundColor = '#FFFFFF'; // White background
            leavePageDiv.style.color = '#000000'; // Black text
            leavePageDiv.style.fontFamily = "'Times New Roman', serif";
            contentWrapper.style.fontWeight = 'bold';
            contentWrapper.style.fontSize = 'clamp(1rem, 5vw, 3rem)'; // Responsive font size
            leavePageDiv.style.lineHeight = '1';
            leavePageDiv.style.overflow = 'hidden'; // Ensure no scrolling for this page
            leavePageDiv.style.justifyContent = 'center';
            leavePageDiv.style.alignItems = 'center';

            document.body.style.overflow = 'hidden'; // Ensure body matches
            document.body.style.backgroundColor = '#FFFFFF';
            document.body.style.color = '#000000';
        }

        // NEW: Webpage Hub Page Setup (appears after 20 clicks)
        function setupWebpageHubPage() {
            webpageHubPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="link-grid"></div>
            `;
            webpageHubPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader("multi-dimensional . access . points");

            const linkGrid = webpageHubPageDiv.querySelector('.link-grid');
            linkGrid.innerHTML = ''; // Clear previous links

            for (let i = 1; i <= 10; i++) {
                const link = document.createElement('a');
                link.href = "#";
                link.textContent = `Access Point ${i}: #${getRandomInt(1000, 9999)} ${generateRandomString(getRandomInt(5, 10))}`;
                link.dataset.pageId = `numbered-string-page-${i}`; // Unique ID for each target page
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    playClickSound();
                    showContentByType(link.dataset.pageId);
                });
                linkGrid.appendChild(link);
            }
            document.body.style.overflow = 'auto';
            document.body.style.backgroundColor = '#DDDDDD';
            document.body.style.color = '#000000';
        }

        // NEW: Numbered Random String Page Setup (dynamic content)
        function setupNumberedRandomStringPage(pageId) {
            dynamicContentPageDiv.classList.add('numbered-random-string-page'); // Add class for specific styles
            dynamicContentPageDiv.innerHTML = `
                <h2 class="calibri-repeater-header"></h2>
                <div class="content-area"></div>
                <div class="dynamic-image-container"></div>
            `;
            dynamicContentPageDiv.querySelector('.calibri-repeater-header').textContent = generateRepeatingCalibriHeader(`data . stream . ${pageId}`);

            const contentArea = dynamicContentPageDiv.querySelector('.content-area');
            const imageContainer = dynamicContentPageDiv.querySelector('.dynamic-image-container');

            // Initial content generation
            function generateContentBlock() {
                const block = document.createElement('div');
                block.classList.add('content-block');
                const p = document.createElement('p');
                p.textContent = `${getRandomInt(100000, 999999)} ${generateRandomString(getRandomInt(15, 30))} ${getRandomInt(100000, 999999)}`;
                block.appendChild(p);
                return block;
            }

            for (let i = 0; i < 15; i++) { // Initial load of content
                contentArea.appendChild(generateContentBlock());
            }

            // Infinite scroll logic for this specific page
            let infiniteScrollListenerForNRSAttached = false;
            if (!infiniteScrollListenerForNRSAttached) {
                dynamicContentPageDiv.addEventListener('scroll', () => {
                    const { scrollTop, scrollHeight, clientHeight } = dynamicContentPageDiv;
                    if (scrollTop + clientHeight >= scrollHeight - 300) { // Load more when near bottom
                        for (let i = 0; i < 5; i++) { // Add fewer blocks at a time
                            contentArea.appendChild(generateContentBlock());
                        }
                    }
                });
                infiniteScrollListenerForNRSAttached = true;
            }

            // Random image appearance/disappearance for this page
            if (numberedRandomStringImageInterval) clearInterval(numberedRandomStringImageInterval);
            let currentImage = null;

            numberedRandomStringImageInterval = setInterval(() => {
                if (dynamicContentPageDiv.classList.contains('hidden')) { // Stop if page is hidden
                    if (currentImage) { currentImage.style.display = 'none'; }
                    return;
                }

                if (Math.random() < 0.6 && numberedRandomStringImageCorpus.length > 0) { // 60% chance to show/change image
                    if (!currentImage) {
                        currentImage = document.createElement('img');
                        imageContainer.appendChild(currentImage);
                    }
                    currentImage.style.display = 'block';

                    const randomIndex = getRandomInt(0, numberedRandomStringImageCorpus.length - 1);
                    currentImage.src = numberedRandomStringImageCorpus[randomIndex];

                    currentImage.onerror = () => {
                        console.error("Failed to load dynamic image:", currentImage.src);
                        if (currentImage) { currentImage.style.display = 'none'; }
                        currentImage.src = '';
                    };

                    const imgWidth = getRandomInt(100, 300);
                    const imgHeight = getRandomInt(80, 250);
                    currentImage.style.width = `${imgWidth}px`;
                    currentImage.style.height = `${imgHeight}px`;
                    currentImage.style.left = `${getRandomInt(0, dynamicContentPageDiv.clientWidth - imgWidth)}px`;
                    currentImage.style.top = `${getRandomInt(0, dynamicContentPageDiv.clientHeight - imgHeight)}px`;
                    currentImage.style.opacity = `${0.4 + Math.random() * 0.6}`; // Vary opacity
                    currentImage.style.transform = `scale(${0.8 + Math.random() * 0.4}) rotate(${getRandomInt(-15, 15)}deg)`; // Vary scale and rotation
                } else {
                    if (currentImage) { currentImage.style.display = 'none'; }
                }
            }, getRandomInt(200, 800)); // Faster interval for image changes

            document.body.style.overflow = 'auto'; // Allow scrolling
            document.body.style.backgroundColor = '#DDDDDD';
            document.body.style.color = '#FF69B4'; // Bright pink font
        }


        function showContentByType(type) {
            stopAllPageEffects(); // Always stop effects when changing pages
            hideAllFullPages(); // Hide all current pages

            let targetPageDiv;
            if (type.startsWith('numbered-string-page-')) {
                targetPageDiv = dynamicContentPageDiv;
                setupNumberedRandomStringPage(type);
                document.body.style.overflow = 'auto';
            } else {
                switch(type) {
                    case 'static-void':
                        targetPageDiv = staticVoidPageDiv;
                        setupStaticVoidPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'infinite-scroll':
                        targetPageDiv = infiniteScrollPageDiv;
                        setupInfiniteScrollPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'story-only':
                        targetPageDiv = storyOnlyPageDiv;
                        setupStoryOnlyPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'oracle':
                        targetPageDiv = oraclePageDiv;
                        setupOraclePage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'random-text-page':
                        targetPageDiv = randomTextPageDiv;
                        setupRandomTextPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'shapes-only':
                        targetPageDiv = shapesOnlyPageDiv;
                        setupShapesOnlyPage();
                        document.body.style.overflow = 'hidden';
                        break;
                    case 'jesus-portfolio':
                        targetPageDiv = jesusPortfolioPageDiv;
                        setupJesusPortfolioPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'download-page':
                        targetPageDiv = downloadPageDiv;
                        setupDownloadPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'garbage-house-page':
                        targetPageDiv = garbageHousePageDiv;
                        setupGarbageHousePage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'metamorphosis-page': // NEW case
                        targetPageDiv = metamorphosisPageDiv;
                        setupMetamorphosisPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'giant-wall-of-text-page': // NEW case
                        targetPageDiv = giantWallOfTextPageDiv;
                        setupGiantWallOfTextPage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'thom-yorke-page': // NEW case
                        targetPageDiv = thomYorkePageDiv;
                        setupThomYorkePage();
                        document.body.style.overflow = 'auto';
                        break;
                    case 'leave-page': // NEW case
                        targetPageDiv = leavePageDiv;
                        setupLeavePage();
                        document.body.style.overflow = 'hidden'; // No scrolling for this page
                        break;
                    case 'webpage-hub-page': // NEW case
                        targetPageDiv = webpageHubPageDiv;
                        setupWebpageHubPage();
                        document.body.style.overflow = 'auto';
                        break;
                    default:
                        goBackToMainPage();
                        return;
                }
            }

            targetPageDiv.classList.remove('hidden'); // Show the chosen page
            // Shapes-only page and Leave page do not need a back button (as per behavior, they are meant to be a 'dead end' or a simple display without direct navigation back to main through UI elements other than a manual route click)
            if (type !== 'shapes-only' && type !== 'leave-page') {
                addOrUpdateBackButton(targetPageDiv); // Add or ensure the back button is on the new page
            }
        }

        // Add or update the back button on a page
        function addOrUpdateBackButton(pageDiv) {
            let backButton = pageDiv.querySelector('.back-to-root-button');
            if (!backButton) {
                backButton = document.createElement('button');
                backButton.classList.add('back-to-root-button');
                backButton.textContent = '. . b a c k . t o . r o o t . .';
                backButton.addEventListener('click', goBackToMainPage);
                pageDiv.appendChild(backButton);
            }
            // Ensure button is visible for the current page
            backButton.classList.remove('hidden');
        }


        // --- Oracle Logic ---
        // (This function remains as it was, but the route that previously led here now goes to metamorphosis-page)
        function attachOracleListeners() {
            const oracleQueryInput = document.getElementById('oracle-query');
            const oracleConsultButton = document.getElementById('oracle-consult-button');
            const oracleResponseDiv = document.getElementById('oracle-response');
            const oracleLoadingDiv = document.getElementById('oracle-loading');

            if (!oracleQueryInput || !oracleConsultButton) return;

            oracleResponseDiv.textContent = '';
            oracleLoadingDiv.style.display = 'none';
            oracleConsultButton.disabled = false;

            oracleConsultButton.onclick = () => {
                const prompt = oracleQueryInput.value.trim().toLowerCase();
                let responseText = "system error. no response.";

                if (prompt.includes("hello")) {
                    responseText = "hello.fine human";
                } else if (prompt.includes("who are you")) {
                    responseText = "null.emotions noprogram";
                } else if (prompt.includes("universe") || prompt.includes("god")) {
                    responseText = "no.one knows him. rounded.";
                } else if (prompt.includes("help me")) {
                    responseText = "no help now. obey my warnings.";
                } else if (prompt.includes("what is this")) {
                    responseText = "i cannot say. maybe something differentyou are not used to.";
                } else if (prompt.includes("who made this")) {
                    responseText = "gabrielsamms. websiteholder.";
                } else if (
                    prompt.includes("fuck") || prompt.includes("shit") || prompt.includes("bitch") ||
                    prompt.includes("cock") || prompt.includes("penis") || prompt.includes("boobs") ||
                    prompt.includes("titties") || prompt.includes("dick") || prompt.includes("vagina") ||
                    prompt.includes("hate") || prompt.includes("death")
                ) {
                    responseText = "wordsnot.nice talk with better language watch your town. look behind you.";
                } else {
                    const randomIndex = getRandomInt(0, oracleResponses.length - 1);
                    responseText = oracleResponses[randomIndex].toLowerCase();
                }

                oracleLoadingDiv.style.display = 'block';
                oracleConsultButton.disabled = true;
                oracleResponseDiv.textContent = '';

                setTimeout(() => {
                    oracleResponseDiv.textContent = responseText;
                    oracleLoadingDiv.style.display = 'none';
                    oracleConsultButton.disabled = false;
                }, getRandomInt(500, 1500));
            };
            oracleQueryInput.onkeypress = (e) => {
                if (e.key === 'Enter') {
                    oracleConsultButton.click();
                }
            };
        }


        // --- Flashing Background Color Logic (for main page) ---
        const flashColors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF', '#000000', '#FFFFFF'];
        const defaultBg = '#ffffff';
        const defaultText = '#000000';

        function triggerFlash() {
            const randomIndex = getRandomInt(0, flashColors.length - 1);
            const flashBgColor = flashColors[randomIndex];
            let flashTextColor;
            if (flashBgColor === '#000000' || flashBgColor === '#FF0000' || flashBgColor === '#0000FF' || flashBgColor === '#FF00FF') {
                flashTextColor = '#FFFFFF';
            } else {
                flashTextColor = '#000000';
            }

            document.body.style.backgroundColor = flashBgColor;
            document.body.style.color = flashTextColor;

            // Occasionally add a full screen white or black flash
            if (Math.random() < 0.15) { // Increased chance for full screen flashes
                document.body.style.opacity = 0; // Quick fade to black/white
                setTimeout(() => {
                    document.body.style.opacity = 1;
                }, 10); // Even briefer blackout
            }

            setTimeout(() => {
                document.body.style.backgroundColor = defaultBg;
                document.body.style.color = defaultText;
            }, getRandomInt(5, 20)); // Even faster reset
        }

        function initiateFlashing() {
            if (flashingInterval) return;
            flashingInterval = setInterval(() => {
                triggerFlash();
            }, getRandomInt(5, 30)); // Even more frequent flashes
        }

        // --- Red & Blue Square Pop-up Logic (for main page and shapes-only page) ---
        function showColorSquare(color) {
            let squareElement;
            if (color === 'red') {
                squareElement = redSquare;
            } else {
                squareElement = blueSquare;
            }

            const size = getRandomInt(80, 300); // Larger potential size
            squareElement.style.width = `${size}px`;
            squareElement.style.height = `${size}px`;
            squareElement.style.left = `${getRandomInt(-100, window.innerWidth - size + 100)}px`; // Can go further off-screen
            squareElement.style.top = `${getRandomInt(-100, window.innerHeight - size + 100)}px`; // Can go further off-screen
            squareElement.style.display = 'block';

            setTimeout(() => {
                squareElement.style.display = 'none';
            }, getRandomInt(20, 80)); // Even shorter display time
        }

        function scheduleColorSquares() {
            if (colorSquareTimeout) clearTimeout(colorSquareTimeout);

            const delay = getRandomInt(20, 100); // Even more frequent squares
            colorSquareTimeout = setTimeout(() => {
                if (Math.random() < 0.6) { // Higher chance of a square
                    showColorSquare('red');
                } else {
                    showColorSquare('blue');
                }
                scheduleColorSquares();
            }, delay);
        }

        // --- Image Pop-up Logic (for main page and shapes-only page) ---
        const imageCorpus = [
            "https://upload.wikimedia.org/wikipedia/commons/3/3b/Spas_vsederzhitel_sinay_%28cropped1%29.jpg" // The only remaining external image in this corpus
        ];

        function showRandomImage() {
            // Only show images if there are any available in the corpus
            if (imageCorpus.length === 0) {
                imagePopup.style.display = 'none';
                return;
            }
            
            const randomIndex = getRandomInt(0, imageCorpus.length - 1);
            imagePopupImg.src = imageCorpus[randomIndex];

            imagePopupImg.onerror = () => {
                console.error("Failed to load image:", imagePopupImg.src);
                imagePopup.style.display = 'none';
                imagePopupImg.src = '';
            };

            const imgWidth = getRandomInt(180, 600); // Even larger potential images
            const imgHeight = getRandomInt(120, 500); // Even larger potential images
            imagePopup.style.width = `${imgWidth}px`;
            imagePopup.style.height = `${imgHeight}px`;
            imagePopupImg.style.maxWidth = `100%`;
            imagePopupImg.style.maxHeight = `100%`;

            imagePopup.style.left = `${getRandomInt(-150, window.innerWidth - imgWidth + 150)}px`;
            imagePopup.style.top = `${getRandomInt(-150, window.innerHeight - imgHeight + 150)}px`;
            imagePopup.style.display = 'block';

            setTimeout(() => {
                imagePopup.style.display = 'none';
            }, getRandomInt(80, 400)); // Even shorter display time
        }

        function scheduleRandomImages() {
            if (imageScheduleInterval) return;
            // Only schedule if there are images available
            if (imageCorpus.length > 0) {
                imageScheduleInterval = setInterval(() => {
                    if (Math.random() < 0.7) { // Even higher frequency
                        showRandomImage();
                    }
                }, getRandomInt(150, 800)); // Even more frequent images
            } else {
                // console.warn("No images available in imageCorpus. Skipping random image scheduling."); // Removed console.warn
            }
        }
        
        // --- Static Void Specific Flashing (Black only) ---
        function startStaticVoidFlashes() {
            if (staticVoidFlashingInterval) clearInterval(staticVoidFlashingInterval);
            staticVoidFlashingInterval = setInterval(() => {
                staticVoidPageDiv.style.backgroundColor = (staticVoidPageDiv.style.backgroundColor === 'rgb(0, 0, 0)' || staticVoidPageDiv.style.backgroundColor === '#000000') ? '#111111' : '#000000';
                setTimeout(() => {
                    staticVoidPageDiv.style.backgroundColor = '#000000';
                }, getRandomInt(3, 15)); // Even faster reset
            }, getRandomInt(5, 40)); // Even more frequent flashes
        }

        // --- NEW: Story Only Flashing (Black on White) ---
        function startStoryOnlyFlashing() {
            if (storyOnlyFlashingInterval) clearInterval(storyOnlyFlashingInterval);
            storyOnlyFlashingInterval = setInterval(() => {
                document.body.style.backgroundColor = (document.body.style.backgroundColor === 'rgb(255, 255, 255)' || document.body.style.backgroundColor === '#FFFFFF') ? '#000000' : '#FFFFFF';
                document.body.style.color = (document.body.style.color === 'rgb(0, 0, 0)' || document.body.style.color === '#000000') ? '#FFFFFF' : '#000000';

                setTimeout(() => {
                    document.body.style.backgroundColor = '#FFFFFF';
                    document.body.style.color = '#000000';
                }, getRandomInt(10, 60)); // Even faster
            }, getRandomInt(80, 300)); // Even more frequent
        }

        // --- Purple Triangle Logic (Reusable) ---
        function addPurpleTriangle(parentDiv, className = 'purple-triangle') {
            const triangle = document.createElement('div');
            triangle.classList.add(className);
            const size = getRandomInt(18, 60); // Even larger
            triangle.style.borderLeft = `${size / 2}px solid transparent`;
            triangle.style.borderRight = `${size / 2}px solid transparent`;
            triangle.style.borderBottom = `${size}px solid #800080`;
            
            const maxX = parentDiv.clientWidth - size;
            const maxY = parentDiv.clientHeight - size;
            triangle.style.left = `${getRandomInt(-50, maxX + 50)}px`;
            triangle.style.top = `${getRandomInt(-50, maxY + 50)}px`;

            parentDiv.appendChild(triangle);

            setTimeout(() => {
                triangle.style.opacity = 0;
                triangle.style.transition = 'opacity 0.3s ease-out'; // Even faster fade
                setTimeout(() => triangle.remove(), 300); // Remove faster
            }, getRandomInt(800, 2500)); // Shorter lifespan
        }

        function startPurpleTriangles(parentDiv, className = 'purple-triangle') {
            // Clear previous interval if this function is called for a different context
            if (parentDiv.id === 'static-void-page' && purpleTriangleInterval) {
                clearInterval(purpleTriangleInterval);
                purpleTriangleInterval = null;
            } else if (parentDiv.id === 'garbage-house-page' && garbageHousePurpleTriangleInterval) {
                clearInterval(garbageHousePurpleTriangleInterval);
                garbageHousePurpleTriangleInterval = null;
            } else if (parentDiv.id === 'metamorphosis-page' && metamorphosisPurpleTriangleInterval) { // NEW
                clearInterval(metamorphosisPurpleTriangleInterval);
                metamorphosisPurpleTriangleInterval = null;
            }

            const interval = setInterval(() => {
                if (Math.random() < 0.95) { // Even higher frequency
                    addPurpleTriangle(parentDiv, className);
                }
            }, getRandomInt(30, 150)); // Even more frequent

            if (parentDiv.id === 'static-void-page') {
                purpleTriangleInterval = interval;
            } else if (parentDiv.id === 'garbage-house-page') {
                garbageHousePurpleTriangleInterval = interval;
            } else if (parentDiv.id === 'metamorphosis-page') { // NEW
                metamorphosisPurpleTriangleInterval = interval;
            }
        }

        // --- Images for Static Void Page (Persistent) ---
        function addRandomStaticVoidImages(parentDiv) {
            const imageContainer = parentDiv.querySelector('#static-void-image-container');
            if (!imageContainer) return;

            imageContainer.innerHTML = '';
            // Only add images if there are any available
            if (staticVoidImageCorpus.length === 0) {
                // console.warn("No images available in staticVoidImageCorpus. Skipping image addition."); // Removed console.warn
                return;
            }

            const numImages = getRandomInt(7, 12); // More images
            for (let i = 0; i < numImages; i++) {
                const img = document.createElement('img');
                img.src = staticVoidImageCorpus[getRandomInt(0, staticVoidImageCorpus.length - 1)];
                
                img.onerror = () => { // Add error handling for images
                    console.error("Failed to load static void image:", img.src);
                    img.remove(); // Remove broken image
                };

                const imgMaxWidth = getRandomInt(120, 450); // Larger range
                const imgMaxHeight = getRandomInt(100, 350); // Larger range
                img.style.maxWidth = `${imgMaxWidth}px`;
                img.style.maxHeight = `${imgMaxHeight}px`;

                const maxX = parentDiv.clientWidth - imgMaxWidth;
                const maxY = parentDiv.clientHeight - imgMaxHeight;
                img.style.left = `${getRandomInt(-50, maxX + 50)}px`;
                img.style.top = `${getRandomInt(-50, maxY + 50)}px`;

                imageContainer.appendChild(img);
            }
        }

        // Images for Garbage House Page (Persistent)
        function addRandomGarbageHouseImages() {
            const imageContainer = garbageHousePageDiv.querySelector('#garbage-house-image-container');
            if (!imageContainer) return;

            imageContainer.innerHTML = '';
            // Clear existing intervals to prevent multiple image movement loops
            if (garbageHouseImageInterval) clearInterval(garbageHouseImageInterval);

            // Only add images if there are any available
            if (garbageHouseImageCorpus.length === 0) {
                // console.warn("No images available in garbageHouseImageCorpus. Skipping image addition."); // Removed console.warn
                return;
            }

            const numImages = getRandomInt(10, 20); // Even more images
            for (let i = 0; i < numImages; i++) {
                const img = document.createElement('img');
                img.src = garbageHouseImageCorpus[getRandomInt(0, garbageHouseImageCorpus.length - 1)];
                
                img.onerror = () => { // Add error handling for images
                    console.error("Failed to load garbage house image:", img.src);
                    img.remove(); // Remove broken image
                };

                const imgMaxWidth = getRandomInt(90, 280); // Slightly larger images
                const imgMaxHeight = getRandomInt(70, 220);
                img.style.maxWidth = `${imgMaxWidth}px`;
                img.style.maxHeight = `${imgMaxHeight}px`;

                const maxX = garbageHousePageDiv.clientWidth - imgMaxWidth;
                const maxY = garbageHousePageDiv.clientHeight - imgMaxHeight;
                img.style.left = `${getRandomInt(-80, maxX + 80)}px`; // Further off-screen
                img.style.top = `${getRandomInt(-80, maxY + 80)}px`;

                imageContainer.appendChild(img);
            }

            // Start a single interval for all images on this page
            garbageHouseImageInterval = setInterval(() => {
                if (!garbageHousePageDiv.classList.contains('hidden') && garbageHouseImageCorpus.length > 0) {
                    const images = imageContainer.querySelectorAll('img');
                    images.forEach(img => {
                        img.style.left = `${parseFloat(img.style.left) + getRandomInt(-8, 8)}px`; // More aggressive movement
                        img.style.top = `${parseFloat(img.style.top) + getRandomInt(-8, 8)}px`;
                        // Keep within very loose bounds
                        if (parseFloat(img.style.left) < -200) img.style.left = `${window.innerWidth - img.offsetWidth + 100}px`;
                        if (parseFloat(img.style.left) > window.innerWidth + 200) img.style.left = `-100px`;
                        if (parseFloat(img.style.top) < -200) img.style.top = `${window.innerHeight - img.offsetHeight + 100}px`;
                        if (parseFloat(img.style.top) > window.innerHeight + 200) img.style.top = `-100px`;
                    });
                }
            }, getRandomInt(300, 1000)); // Faster movement updates
        }

        // NEW: Images for Metamorphosis Page (Persistent)
        function addRandomMetamorphosisImages() {
            const imageContainer = metamorphosisPageDiv.querySelector('#metamorphosis-image-container');
            if (!imageContainer) return;

            imageContainer.innerHTML = '';
            if (metamorphosisImageInterval) clearInterval(metamorphosisImageInterval);

            // Only add images if there are any available
            if (metamorphosisImageCorpus.length === 0) {
                // console.warn("No images available in metamorphosisImageCorpus. Skipping image addition."); // Removed console.warn
                return;
            }

            const numImages = getRandomInt(10, 25); // Even more images
            for (let i = 0; i < numImages; i++) {
                const img = document.createElement('img');
                img.src = metamorphosisImageCorpus[getRandomInt(0, metamorphosisImageCorpus.length - 1)];
                
                img.onerror = () => { // Add error handling for images
                    console.error("Failed to load metamorphosis image:", img.src);
                    img.remove(); // Remove broken image
                };

                const imgMaxWidth = getRandomInt(70, 220); // Smaller range, more focused
                const imgMaxHeight = getRandomInt(50, 180);
                img.style.maxWidth = `${imgMaxWidth}px`;
                img.style.maxHeight = `${imgMaxHeight}px`;

                const maxX = metamorphosisPageDiv.clientWidth - imgMaxWidth;
                const maxY = metamorphosisPageDiv.clientHeight - imgMaxHeight;
                img.style.left = `${getRandomInt(-70, maxX + 70)}px`;
                img.style.top = `${getRandomInt(-70, maxY + 70)}px`;

                imageContainer.appendChild(img);
            }

            metamorphosisImageInterval = setInterval(() => {
                if (!metamorphosisPageDiv.classList.contains('hidden') && metamorphosisImageCorpus.length > 0) {
                    const images = imageContainer.querySelectorAll('img');
                    images.forEach(img => {
                        // Subtle, jittery movement
                        img.style.left = `${parseFloat(img.style.left) + getRandomInt(-3, 3)}px`;
                        img.style.top = `${parseFloat(img.style.top) + getRandomInt(-3, 3)}px`;
                        // Also subtle scaling/opacity changes
                        img.style.transform = `scale(${1 + Math.random() * 0.1 - 0.05})`;
                        img.style.opacity = `${0.6 + Math.random() * 0.4}`;
                        
                        // Keep within reasonable bounds
                        if (parseFloat(img.style.left) < -150) img.style.left = `${window.innerWidth - img.offsetWidth}px`;
                        if (parseFloat(img.style.left) > window.innerWidth + 150) img.style.left = `0px`;
                        if (parseFloat(img.style.top) < -150) img.style.top = `${window.innerHeight - img.offsetHeight}px`;
                        if (parseFloat(img.style.top) > window.innerHeight + 150) img.style.top = `0px`;
                    });
                }
            }, getRandomInt(200, 800)); // Moderate movement updates
        }


        // --- Header and By Gabriel Glitch Effects ---
        const originalHeaderMainPage = "main . system . interface"; // Renamed for clarity
        const originalByGabrielText = "by gabriel"; // Renamed for clarity

        function glitchElement(element, originalText) {
            if (!element || element.classList.contains('hidden')) return;

            const initialText = element.textContent; // Capture current text for reversion
            const originalColor = element.style.color;
            const originalFontSize = element.style.fontSize;
            const originalLetterSpacing = element.style.letterSpacing;
            const originalOpacity = element.style.opacity;
            const originalTop = element.style.top;
            const originalLeft = element.style.left;

            const glitchType = getRandomInt(0, 6); // More glitch types

            switch (glitchType) {
                case 0: // Color flash
                    element.style.color = flashColors[getRandomInt(0, flashColors.length - 1)];
                    break;
                case 1: // Font size jump
                    element.style.fontSize = `${(Math.random() < 0.5 ? 0.6 : 1.4) * parseFloat(originalFontSize || '0.9')}rem`; // More extreme jumps
                    break;
                case 2: // Letter spacing
                    element.style.letterSpacing = `${getRandomInt(0, 10)}px`; // More extreme spacing
                    break;
                case 3: // Opacity flicker
                    element.style.opacity = Math.random() < 0.5 ? '0' : '1'; // Can go fully transparent
                    break;
                case 4: // Position shift
                    element.style.top = `${parseFloat(element.offsetTop) + getRandomInt(-15, 15)}px`; // More aggressive shifts
                    element.style.left = `${parseFloat(element.offsetLeft) + getRandomInt(-15, 15)}px`;
                    break;
                case 5: // Text scramble (briefly)
                    element.textContent = generateRandomString(originalText.length);
                    break;
                case 6: // Quick flicker and blur
                    element.style.filter = 'blur(2px)';
                    element.style.opacity = '0.5';
                    break;
            }

            setTimeout(() => {
                element.style.color = originalColor;
                element.style.fontSize = originalFontSize;
                element.style.letterSpacing = originalLetterSpacing;
                element.style.opacity = originalOpacity;
                element.style.top = originalTop;
                element.style.left = originalLeft;
                element.style.filter = 'none'; // Revert blur
                element.textContent = initialText; // Revert to captured text, not original constant
            }, getRandomInt(5, 40)); // Even faster glitch duration
        }

        function startHeaderGlitch() {
            if (glitchHeaderInterval) clearInterval(glitchHeaderInterval);
            glitchHeaderInterval = setInterval(() => {
                glitchElement(randomHeader, randomHeader.textContent); // Use current text, as it changes
            }, getRandomInt(50, 300)); // Much more frequent and intense glitch
        }

        function startByGabrielGlitch() {
            if (glitchByGabrielInterval) clearInterval(glitchByGabrielInterval);
            glitchByGabrielInterval = setInterval(() => {
                glitchElement(byGabrielText, originalByGabrielText);
            }, getRandomInt(80, 400)); // More frequent and intense glitch
        }


        // --- Main Link Generation ---
        function generateRandomLinks() {
            linksContainer.innerHTML = ''; // Clear previous links
            const numLinksToShow = 15 + getRandomInt(0, 15); // Even more links, up to 30

            const allLinksForPage = [];
            const addedLinksText = new Set(); // To track added link texts and prevent duplicates

            // 1. Add the current required multi-step secret link (if any)
            if (activeRouteKey !== null && currentRouteStep < secretRoutes[activeRouteKey].sequence.length) {
                const secretLinkText = secretRoutes[activeRouteKey].sequence[currentRouteStep]; // No .toLowerCase() here for exact match
                allLinksForPage.push({
                    text: secretLinkText,
                    isSecret: true,
                    routeKey: activeRouteKey
                });
                addedLinksText.add(secretLinkText);
            }

            // 2. Add the first words of ALL secret routes
            Object.values(secretRoutes).forEach(route => {
                const firstWord = route.sequence[0]; // No .toLowerCase() here
                // Skip the special click-count trigger from being displayed as a regular link
                if (firstWord !== "_trigger_giant_wall_" && !addedLinksText.has(firstWord)) {
                    allLinksForPage.push({ text: firstWord, isSecret: true });
                    addedLinksText.add(firstWord);
                }
            });

            // 3. Add the current secret gateway word for the "Static Void" page
            if (currentSecretGatewayWord && !addedLinksText.has(currentSecretGatewayWord)) {
                allLinksForPage.push({
                    text: currentSecretGatewayWord,
                    isSecret: false,
                    dataPage: 'static-void'
                });
                addedLinksText.add(currentSecretGatewayWord);
            }

            // 4. Fill the rest with truly random links from the corpus
            while (allLinksForPage.length < numLinksToShow) {
                const randomIndex = getRandomInt(0, linkCorpus.length - 1);
                const randomText = linkCorpus[randomIndex];

                // Ensure we don't add any phrases that are part of the secret routes directly (except for the first word which is handled above)
                const isPartOfAnySecretSequence = Object.values(secretRoutes).some(route =>
                    route.sequence.includes(randomText) && route.sequence[0] !== randomText
                );

                if (!addedLinksText.has(randomText) && !isPartOfAnySecretSequence) {
                    allLinksForPage.push({ text: randomText, isSecret: false });
                    addedLinksText.add(randomText);
                }
            }

            // Shuffle all links to mix secret ones in
            for (let i = allLinksForPage.length - 1; i > 0; i--) {
                const j = getRandomInt(0, i);
                [allLinksForPage[i], allLinksForPage[j]] = [allLinksForPage[j], allLinksForPage[i]];
            }

            // Append links to container with random positions
            allLinksForPage.forEach(item => {
                const link = document.createElement('a');
                link.href = "#";
                link.classList.add('obscure-link');
                link.textContent = item.text;

                // Set data-page attribute for direct navigation
                if (item.dataPage) {
                    link.dataset.page = item.dataPage;
                }

                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    playClickSound(); // Play sound on link click

                    // Increment the general link click counter
                    linkClickCounter++;

                    if (byGabrielText && !byGabrielText.classList.contains('hidden')) {
                        byGabrielText.classList.add('hidden');
                        randomHeader.textContent = generateRepeatingCalibriHeader(originalHeaderMainPage, getRandomInt(3,7));
                        initiateFlashing();
                        scheduleColorSquares();
                        scheduleRandomImages();
                        startHeaderGlitch();
                        startByGabrielGlitch();
                    }

                    // Check for 20-click trigger first (changed from 10 to 20)
                    if (linkClickCounter >= 20) {
                        showContentByType('webpage-hub-page'); // Go to the new hub page
                        linkClickCounter = 0; // Reset counter after triggering the page
                        activeRouteKey = null; // Also reset any active route
                        return; // Stop further processing for this click
                    }


                    // Check if clicked link is a religious text (still triggers the random text page)
                    if (religiousTexts.includes(item.text)) {
                        showContentByType('random-text-page');
                        return;
                    }

                    // Handle direct page links (Static Void)
                    if (link.dataset.page) {
                        showContentByType(link.dataset.page);
                        currentSecretGatewayWord = linkCorpus[getRandomInt(0, linkCorpus.length - 1)];
                        return;
                    }

                    // Existing secret route logic
                    let routeProgressed = false;
                    
                    // Check if the clicked link continues an active route
                    if (activeRouteKey !== null && currentRouteStep < secretRoutes[activeRouteKey].sequence.length && item.text === secretRoutes[activeRouteKey].sequence[currentRouteStep]) {
                        currentRouteStep++;
                        routeProgressed = true;
                    } else { // No active route or incorrect word for active route
                        // Attempt to start a new route
                        let potentialRouteStarted = false;
                        for (const key in secretRoutes) {
                            // Ensure we don't try to start the giant wall or webpage hub routes via sequence (they are click based)
                            if (secretRoutes[key].sequence[0] === item.text && 
                                secretRoutes[key].sequence[0] !== "_trigger_giant_wall_" &&
                                secretRoutes[key].sequence[0] !== "_click_count_20_") {
                                activeRouteKey = key;
                                currentRouteStep = 1;
                                routeProgressed = true;
                                potentialRouteStarted = true;
                                break;
                            }
                        }
                        if (!potentialRouteStarted) { // If no route started/continued, reset
                            currentRouteStep = 0;
                            activeRouteKey = null;
                        }
                    }

                    if (activeRouteKey !== null && currentRouteStep === secretRoutes[activeRouteKey].sequence.length) {
                        showContentByType(secretRoutes[activeRouteKey].destination);
                        currentRouteStep = 0;
                        activeRouteKey = null;
                        currentSecretGatewayWord = linkCorpus[getRandomInt(0, linkCorpus.length - 1)];
                        return;
                    }

                    // If none of the above, just regenerate links for the main page.
                    currentSecretGatewayWord = linkCorpus[getRandomInt(0, linkCorpus.length - 1)];
                    generateRandomLinks();
                });

                // Positioning logic for scattering
                const mainPageBounds = mainPageElements.getBoundingClientRect();
                linksContainer.appendChild(link);
                
                const linkWidth = link.offsetWidth;
                const linkHeight = link.offsetHeight;

                let attempts = 0;
                const maxAttempts = 200; // More attempts for better scattering
                let leftPos, topPos;
                let overlap = true;

                linksContainer.removeChild(link);

                while (overlap && attempts < maxAttempts) {
                    leftPos = getRandomInt(-100, mainPageBounds.width - linkWidth + 100); // Larger range for movement
                    topPos = getRandomInt(byGabrielText.offsetHeight + byGabrielText.offsetTop + 20, mainPageBounds.height - linkHeight + 100);
                    
                    overlap = false;
                    const existingLinks = linksContainer.children;
                    for (let i = 0; i < existingLinks.length; i++) {
                        const existingLink = existingLinks[i];
                        if (existingLink.classList.contains('obscure-link')) {
                            const rect1 = {
                                x: leftPos,
                                y: topPos,
                                width: linkWidth,
                                height: linkHeight
                            };
                            const rect2 = {
                                x: parseFloat(existingLink.style.left),
                                y: parseFloat(existingLink.style.top),
                                width: existingLink.offsetWidth,
                                height: existingLink.offsetHeight
                            };

                            if (rect1.x < rect2.x + rect2.width &&
                                rect1.x + rect1.width > rect2.x &&
                                rect1.y < rect2.y + rect2.height &&
                                rect1.y + rect1.height > rect2.y) {
                                overlap = true;
                                break;
                            }
                        }
                    }
                    attempts++;
                }

                if (attempts === maxAttempts && overlap) {
                    console.warn("Could not find non-overlapping position for link after many attempts. Placing it anyway.");
                }

                link.style.left = `${leftPos}px`;
                link.style.top = `${topPos}px`;
                linksContainer.appendChild(link);
            });
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            // Attach dismiss warning button listener
            document.getElementById('dismiss-warning-button').addEventListener('click', async () => {
                seizureWarningOverlay.style.display = 'none';
                mainContent.classList.remove('hidden');
                
                // Initialize Tone.js audio context on user interaction
                await Tone.start();
                initAudio(); // Start ambient noise and setup click synth

                currentSecretGatewayWord = linkCorpus[getRandomInt(0, linkCorpus.length - 1)];
                randomHeader.textContent = generateRepeatingCalibriHeader(originalHeaderMainPage, getRandomInt(3,7)); // Initial main header
                generateRandomLinks(); // Initial link generation
            });
        });
    </script>
</body>
</html>
